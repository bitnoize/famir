// Auto-generated file. Do not edit manually!

// prettier-ignore
const REDIS_FUNCTIONS = [
  // 1-campaign.lua
  `IyFsdWEgbmFtZT1jYW1wYWlnbgoKLS1bWwogIENyZWF0ZSBjYW1wYWlnbgotLV1dCmxvY2FsIGZ1bmN0aW9uIGNyZWF0ZV9jYW1wYWlnbihrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gMyBhbmQgI2FyZ3MgPT0gMTEpIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCBjYW1wYWlnbl91bmlxdWVfbWlycm9yX2RvbWFpbl9rZXkgPSBrZXlzWzJdCiAgbG9jYWwgY2FtcGFpZ25faW5kZXhfa2V5ID0ga2V5c1szXQoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGNhbXBhaWduX2tleSkgPT0gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnQ09ORkxJQ1QgQ2FtcGFpZ24gYWxscmVhZHkgZXhpc3RzJykKICBlbmQKCiAgbG9jYWwgbW9kZWwgPSB7CiAgICBjYW1wYWlnbl9pZCA9IGFyZ3NbMV0sCiAgICBtaXJyb3JfZG9tYWluID0gYXJnc1syXSwKICAgIGRlc2NyaXB0aW9uID0gYXJnc1szXSwKICAgIGxhbmRpbmdfdXBncmFkZV9wYXRoID0gYXJnc1s0XSwKICAgIGxhbmRpbmdfdXBncmFkZV9wYXJhbSA9IGFyZ3NbNV0sCiAgICBsYW5kaW5nX3JlZGlyZWN0b3JfcGFyYW0gPSBhcmdzWzZdLAogICAgc2Vzc2lvbl9jb29raWVfbmFtZSA9IGFyZ3NbN10sCiAgICBzZXNzaW9uX2V4cGlyZSA9IHRvbnVtYmVyKGFyZ3NbOF0pLAogICAgbmV3X3Nlc3Npb25fZXhwaXJlID0gdG9udW1iZXIoYXJnc1s5XSksCiAgICBtZXNzYWdlX2V4cGlyZSA9IHRvbnVtYmVyKGFyZ3NbMTBdKSwKICAgIHNlc3Npb25fY291bnQgPSAwLAogICAgbWVzc2FnZV9jb3VudCA9IDAsCiAgICBjcmVhdGVkX2F0ID0gdG9udW1iZXIoYXJnc1sxMV0pLAogICAgdXBkYXRlZF9hdCA9IHRvbnVtYmVyKGFyZ3NbMTFdKSwKICB9CgogIGZvciBmaWVsZCwgdmFsdWUgaW4gcGFpcnMobW9kZWwpIGRvCiAgICBpZiBub3QgdmFsdWUgdGhlbgogICAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBtb2RlbC4nIC4uIGZpZWxkKQogICAgZW5kCiAgZW5kCgogIGlmIG5vdCAoI21vZGVsLmNhbXBhaWduX2lkID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwuY2FtcGFpZ25faWQnKQogIGVuZAoKICBpZiBub3QgKCNtb2RlbC5taXJyb3JfZG9tYWluID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwubWlycm9yX2RvbWFpbicpCiAgZW5kCgogIGlmIG5vdCAobW9kZWwuc2Vzc2lvbl9leHBpcmUgPiAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBtb2RlbC5zZXNzaW9uX2V4cGlyZScpCiAgZW5kCgogIGlmIG5vdCAobW9kZWwubmV3X3Nlc3Npb25fZXhwaXJlID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwubmV3X3Nlc3Npb25fZXhwaXJlJykKICBlbmQKCiAgaWYgbm90IChtb2RlbC5tZXNzYWdlX2V4cGlyZSA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLm1lc3NhZ2VfZXhwaXJlJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdTSVNNRU1CRVInLCBjYW1wYWlnbl91bmlxdWVfbWlycm9yX2RvbWFpbl9rZXksIG1vZGVsLm1pcnJvcl9kb21haW4pID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ0NPTkZMSUNUIENhbXBhaWduIG1pcnJvcl9kb21haW4gYWxscmVhZHkgdGFrZW4nKQogIGVuZAoKICAtLSBQb2ludCBvZiBubyByZXR1cm4KCiAgbG9jYWwgc3RvcmUgPSB7fQoKICBmb3IgZmllbGQsIHZhbHVlIGluIHBhaXJzKG1vZGVsKSBkbwogICAgdGFibGUuaW5zZXJ0KHN0b3JlLCBmaWVsZCkKICAgIHRhYmxlLmluc2VydChzdG9yZSwgdmFsdWUpCiAgZW5kCgogIHJlZGlzLmNhbGwoJ0hTRVQnLCBjYW1wYWlnbl9rZXksIHVucGFjayhzdG9yZSkpCgogIHJlZGlzLmNhbGwoJ1pBREQnLCBjYW1wYWlnbl9pbmRleF9rZXksIG1vZGVsLmNyZWF0ZWRfYXQsIG1vZGVsLmNhbXBhaWduX2lkKQoKICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBDYW1wYWlnbiBjcmVhdGVkJykKZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICdjcmVhdGVfY2FtcGFpZ24nLAogIGNhbGxiYWNrID0gY3JlYXRlX2NhbXBhaWduLAogIGRlc2NyaXB0aW9uID0gJ0NyZWF0ZSBjYW1wYWlnbicsCn0pCgotLVtbCiAgUmVhZCBjYW1wYWlnbgotLV1dCmxvY2FsIGZ1bmN0aW9uIHJlYWRfY2FtcGFpZ24oa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDEgYW5kICNhcmdzID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBjYW1wYWlnbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiBuaWwKICBlbmQKCiAgLS0gc3R5bHVhOiBpZ25vcmUKICBsb2NhbCB2YWx1ZXMgPSByZWRpcy5jYWxsKAogICAgJ0hNR0VUJywgY2FtcGFpZ25fa2V5LAogICAgJ2NhbXBhaWduX2lkJywKICAgICdtaXJyb3JfZG9tYWluJywKICAgICdzZXNzaW9uX2NvdW50JywKICAgICdtZXNzYWdlX2NvdW50JywKICAgICdjcmVhdGVkX2F0JywKICAgICd1cGRhdGVkX2F0JwogICkKCiAgaWYgbm90ICgjdmFsdWVzID09IDYpIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gdmFsdWVzJykKICBlbmQKCiAgbG9jYWwgbW9kZWwgPSB7CiAgICBjYW1wYWlnbl9pZCA9IHZhbHVlc1sxXSwKICAgIG1pcnJvcl9kb21haW4gPSB2YWx1ZXNbMl0sCiAgICBzZXNzaW9uX2NvdW50ID0gdG9udW1iZXIodmFsdWVzWzNdKSwKICAgIG1lc3NhZ2VfY291bnQgPSB0b251bWJlcih2YWx1ZXNbNF0pLAogICAgY3JlYXRlZF9hdCA9IHRvbnVtYmVyKHZhbHVlc1s1XSksCiAgICB1cGRhdGVkX2F0ID0gdG9udW1iZXIodmFsdWVzWzZdKSwKICB9CgogIGZvciBmaWVsZCwgdmFsdWUgaW4gcGFpcnMobW9kZWwpIGRvCiAgICBpZiBub3QgdmFsdWUgdGhlbgogICAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIG1vZGVsLicgLi4gZmllbGQpCiAgICBlbmQKICBlbmQKCiAgcmV0dXJuIHsgbWFwID0gbW9kZWwgfQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ3JlYWRfY2FtcGFpZ24nLAogIGNhbGxiYWNrID0gcmVhZF9jYW1wYWlnbiwKICBmbGFncyA9IHsgJ25vLXdyaXRlcycgfSwKICBkZXNjcmlwdGlvbiA9ICdSZWFkIGNhbXBhaWduJywKfSkKCi0tW1sKICBSZWFkIGZ1bGwgY2FtcGFpZ24KLS1dXQpsb2NhbCBmdW5jdGlvbiByZWFkX2Z1bGxfY2FtcGFpZ24oa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDUgYW5kICNhcmdzID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCBwcm94eV9pbmRleF9rZXkgPSBrZXlzWzJdCiAgbG9jYWwgdGFyZ2V0X2luZGV4X2tleSA9IGtleXNbM10KICBsb2NhbCByZWRpcmVjdG9yX2luZGV4X2tleSA9IGtleXNbNF0KICBsb2NhbCBsdXJlX2luZGV4X2tleSA9IGtleXNbNV0KCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBjYW1wYWlnbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiBuaWwKICBlbmQKCiAgLS0gc3R5bHVhOiBpZ25vcmUKICBsb2NhbCB2YWx1ZXMgPSByZWRpcy5jYWxsKAogICAgJ0hNR0VUJywgY2FtcGFpZ25fa2V5LAogICAgJ2NhbXBhaWduX2lkJywKICAgICdtaXJyb3JfZG9tYWluJywKICAgICdkZXNjcmlwdGlvbicsCiAgICAnbGFuZGluZ191cGdyYWRlX3BhdGgnLAogICAgJ2xhbmRpbmdfdXBncmFkZV9wYXJhbScsCiAgICAnbGFuZGluZ19yZWRpcmVjdG9yX3BhcmFtJywKICAgICdzZXNzaW9uX2Nvb2tpZV9uYW1lJywKICAgICdzZXNzaW9uX2V4cGlyZScsCiAgICAnbmV3X3Nlc3Npb25fZXhwaXJlJywKICAgICdtZXNzYWdlX2V4cGlyZScsCiAgICAnc2Vzc2lvbl9jb3VudCcsCiAgICAnbWVzc2FnZV9jb3VudCcsCiAgICAnY3JlYXRlZF9hdCcsCiAgICAndXBkYXRlZF9hdCcKICApCgogIGlmIG5vdCAoI3ZhbHVlcyA9PSAxNCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSB2YWx1ZXMnKQogIGVuZAoKICBsb2NhbCBtb2RlbCA9IHsKICAgIGNhbXBhaWduX2lkID0gdmFsdWVzWzFdLAogICAgbWlycm9yX2RvbWFpbiA9IHZhbHVlc1syXSwKICAgIGRlc2NyaXB0aW9uID0gdmFsdWVzWzNdLAogICAgbGFuZGluZ191cGdyYWRlX3BhdGggPSB2YWx1ZXNbNF0sCiAgICBsYW5kaW5nX3VwZ3JhZGVfcGFyYW0gPSB2YWx1ZXNbNV0sCiAgICBsYW5kaW5nX3JlZGlyZWN0b3JfcGFyYW0gPSB2YWx1ZXNbNl0sCiAgICBzZXNzaW9uX2Nvb2tpZV9uYW1lID0gdmFsdWVzWzddLAogICAgc2Vzc2lvbl9leHBpcmUgPSB0b251bWJlcih2YWx1ZXNbOF0pLAogICAgbmV3X3Nlc3Npb25fZXhwaXJlID0gdG9udW1iZXIodmFsdWVzWzldKSwKICAgIG1lc3NhZ2VfZXhwaXJlID0gdG9udW1iZXIodmFsdWVzWzEwXSksCiAgICBwcm94eV9jb3VudCA9IHJlZGlzLmNhbGwoJ1pDQVJEJywgcHJveHlfaW5kZXhfa2V5KSwKICAgIHRhcmdldF9jb3VudCA9IHJlZGlzLmNhbGwoJ1pDQVJEJywgdGFyZ2V0X2luZGV4X2tleSksCiAgICByZWRpcmVjdG9yX2NvdW50ID0gcmVkaXMuY2FsbCgnWkNBUkQnLCByZWRpcmVjdG9yX2luZGV4X2tleSksCiAgICBsdXJlX2NvdW50ID0gcmVkaXMuY2FsbCgnWkNBUkQnLCBsdXJlX2luZGV4X2tleSksCiAgICBzZXNzaW9uX2NvdW50ID0gdG9udW1iZXIodmFsdWVzWzExXSksCiAgICBtZXNzYWdlX2NvdW50ID0gdG9udW1iZXIodmFsdWVzWzEyXSksCiAgICBjcmVhdGVkX2F0ID0gdG9udW1iZXIodmFsdWVzWzEzXSksCiAgICB1cGRhdGVkX2F0ID0gdG9udW1iZXIodmFsdWVzWzE0XSksCiAgfQoKICBmb3IgZmllbGQsIHZhbHVlIGluIHBhaXJzKG1vZGVsKSBkbwogICAgaWYgbm90IHZhbHVlIHRoZW4KICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBtb2RlbC4nIC4uIGZpZWxkKQogICAgZW5kCiAgZW5kCgogIHJldHVybiB7IG1hcCA9IG1vZGVsIH0KZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICdyZWFkX2Z1bGxfY2FtcGFpZ24nLAogIGNhbGxiYWNrID0gcmVhZF9mdWxsX2NhbXBhaWduLAogIGZsYWdzID0geyAnbm8td3JpdGVzJyB9LAogIGRlc2NyaXB0aW9uID0gJ1JlYWQgZnVsbCBjYW1wYWlnbicsCn0pCgotLVtbCiAgUmVhZCBjYW1wYWlnbiBpbmRleAotLV1dCmxvY2FsIGZ1bmN0aW9uIHJlYWRfY2FtcGFpZ25faW5kZXgoa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDEgYW5kICNhcmdzID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2luZGV4X2tleSA9IGtleXNbMV0KCiAgcmV0dXJuIHJlZGlzLmNhbGwoJ1pSQU5HRScsIGNhbXBhaWduX2luZGV4X2tleSwgMCwgLTEpCmVuZAoKcmVkaXMucmVnaXN0ZXJfZnVuY3Rpb24oewogIGZ1bmN0aW9uX25hbWUgPSAncmVhZF9jYW1wYWlnbl9pbmRleCcsCiAgY2FsbGJhY2sgPSByZWFkX2NhbXBhaWduX2luZGV4LAogIGZsYWdzID0geyAnbm8td3JpdGVzJyB9LAogIGRlc2NyaXB0aW9uID0gJ1JlYWQgY2FtcGFpZ24gaW5kZXgnLAp9KQoKLS1bWwogIFVwZGF0ZSBjYW1wYWlnbgotLV1dCmxvY2FsIGZ1bmN0aW9uIHVwZGF0ZV9jYW1wYWlnbihrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gMSBhbmQgI2FyZ3MgPj0gMCBhbmQgI2FyZ3MgJSAyID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBjYW1wYWlnbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBDYW1wYWlnbiBub3QgZm91bmQnKQogIGVuZAoKICBsb2NhbCBtb2RlbCA9IHt9CgogIGZvciBpID0gMSwgI2FyZ3MsIDIgZG8KICAgIGxvY2FsIGZpZWxkLCB2YWx1ZSA9IGFyZ3NbaV0sIGFyZ3NbaSArIDFdCgogICAgaWYgbW9kZWxbZmllbGRdIHRoZW4KICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgRHVwbGljYXRlIG1vZGVsLicgLi4gZmllbGQpCiAgICBlbmQKCiAgICBpZiBmaWVsZCA9PSAnZGVzY3JpcHRpb24nIHRoZW4KICAgICAgbW9kZWwuZGVzY3JpcHRpb24gPSB2YWx1ZQoKICAgICAgaWYgbm90IG1vZGVsLmRlc2NyaXB0aW9uIHRoZW4KICAgICAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBtb2RlbC5kZXNjcmlwdGlvbicpCiAgICAgIGVuZAogICAgZWxzZWlmIGZpZWxkID09ICdzZXNzaW9uX2V4cGlyZScgdGhlbgogICAgICBtb2RlbC5zZXNzaW9uX2V4cGlyZSA9IHRvbnVtYmVyKHZhbHVlKQoKICAgICAgaWYgbm90IChtb2RlbC5zZXNzaW9uX2V4cGlyZSBhbmQgbW9kZWwuc2Vzc2lvbl9leHBpcmUgPiAwKSB0aGVuCiAgICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwuc2Vzc2lvbl9leHBpcmUnKQogICAgICBlbmQKICAgIGVsc2VpZiBmaWVsZCA9PSAnbmV3X3Nlc3Npb25fZXhwaXJlJyB0aGVuCiAgICAgIG1vZGVsLm5ld19zZXNzaW9uX2V4cGlyZSA9IHRvbnVtYmVyKHZhbHVlKQoKICAgICAgaWYgbm90IChtb2RlbC5uZXdfc2Vzc2lvbl9leHBpcmUgYW5kIG1vZGVsLm5ld19zZXNzaW9uX2V4cGlyZSA+IDApIHRoZW4KICAgICAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBtb2RlbC5uZXdfc2Vzc2lvbl9leHBpcmUnKQogICAgICBlbmQKICAgIGVsc2VpZiBmaWVsZCA9PSAnbWVzc2FnZV9leHBpcmUnIHRoZW4KICAgICAgbW9kZWwubWVzc2FnZV9leHBpcmUgPSB0b251bWJlcih2YWx1ZSkKCiAgICAgIGlmIG5vdCAobW9kZWwubWVzc2FnZV9leHBpcmUgYW5kIG1vZGVsLm1lc3NhZ2VfZXhwaXJlID4gMCkgdGhlbgogICAgICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLm1lc3NhZ2VfZXhwaXJlJykKICAgICAgZW5kCiAgICBlbHNlaWYgZmllbGQgPT0gJ3VwZGF0ZWRfYXQnIHRoZW4KICAgICAgbW9kZWwudXBkYXRlZF9hdCA9IHRvbnVtYmVyKHZhbHVlKQoKICAgICAgaWYgbm90IG1vZGVsLnVwZGF0ZWRfYXQgdGhlbgogICAgICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLnVwZGF0ZWRfYXQnKQogICAgICBlbmQKICAgIGVsc2UKICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgVW5rbm93biBtb2RlbC4nIC4uIGZpZWxkKQogICAgZW5kCiAgZW5kCgogIGlmIG5leHQobW9kZWwpID09IG5pbCB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBOb3RoaW5nIHRvIHVwZGF0ZScpCiAgZW5kCgogIC0tIFBvaW50IG9mIG5vIHJldHVybgoKICBsb2NhbCBzdG9yZSA9IHt9CgogIGZvciBmaWVsZCwgdmFsdWUgaW4gcGFpcnMobW9kZWwpIGRvCiAgICB0YWJsZS5pbnNlcnQoc3RvcmUsIGZpZWxkKQogICAgdGFibGUuaW5zZXJ0KHN0b3JlLCB2YWx1ZSkKICBlbmQKCiAgcmVkaXMuY2FsbCgnSFNFVCcsIGNhbXBhaWduX2tleSwgdW5wYWNrKHN0b3JlKSkKCiAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnT0sgQ2FtcGFpZ24gdXBkYXRlZCcpCmVuZAoKcmVkaXMucmVnaXN0ZXJfZnVuY3Rpb24oewogIGZ1bmN0aW9uX25hbWUgPSAndXBkYXRlX2NhbXBhaWduJywKICBjYWxsYmFjayA9IHVwZGF0ZV9jYW1wYWlnbiwKICBkZXNjcmlwdGlvbiA9ICdVcGRhdGUgY2FtcGFpZ24nLAp9KQoKLS1bWwogIERlbGV0ZSBjYW1wYWlnbgotLV1dCmxvY2FsIGZ1bmN0aW9uIGRlbGV0ZV9jYW1wYWlnbihrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gNyBhbmQgI2FyZ3MgPT0gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgZnVuY3Rpb24gdXNlJykKICBlbmQKCiAgbG9jYWwgY2FtcGFpZ25fa2V5ID0ga2V5c1sxXQogIGxvY2FsIGNhbXBhaWduX3VuaXF1ZV9taXJyb3JfZG9tYWluX2tleSA9IGtleXNbMl0KICBsb2NhbCBjYW1wYWlnbl9pbmRleF9rZXkgPSBrZXlzWzNdCiAgbG9jYWwgcHJveHlfaW5kZXhfa2V5ID0ga2V5c1s0XQogIGxvY2FsIHRhcmdldF9pbmRleF9rZXkgPSBrZXlzWzVdCiAgbG9jYWwgcmVkaXJlY3Rvcl9pbmRleF9rZXkgPSBrZXlzWzZdCiAgbG9jYWwgbHVyZV9pbmRleF9rZXkgPSBrZXlzWzddCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgY2FtcGFpZ25fa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdOT1RfRk9VTkQgQ2FtcGFpZ24gbm90IGZvdW5kJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdaQ0FSRCcsIHByb3h5X2luZGV4X2tleSkgPT0gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnRk9SQklEREVOIENhbXBhaWduIHByb3hpZXMgZXhpc3RzJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdaQ0FSRCcsIHRhcmdldF9pbmRleF9rZXkpID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ0ZPUkJJRERFTiBDYW1wYWlnbiB0YXJnZXRzIGV4aXN0cycpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnWkNBUkQnLCByZWRpcmVjdG9yX2luZGV4X2tleSkgPT0gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnRk9SQklEREVOIENhbXBhaWduIHJlZGlyZWN0b3JzIGV4aXN0cycpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnWkNBUkQnLCBsdXJlX2luZGV4X2tleSkgPT0gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnRk9SQklEREVOIENhbXBhaWduIGx1cmVzIGV4aXN0cycpCiAgZW5kCgogIGxvY2FsIHN0YXNoID0gewogICAgY2FtcGFpZ25faWQgPSByZWRpcy5jYWxsKCdIR0VUJywgY2FtcGFpZ25fa2V5LCAnY2FtcGFpZ25faWQnKSwKICAgIG1pcnJvcl9kb21haW4gPSByZWRpcy5jYWxsKCdIR0VUJywgY2FtcGFpZ25fa2V5LCAnbWlycm9yX2RvbWFpbicpLAogIH0KCiAgaWYgbm90IChzdGFzaC5jYW1wYWlnbl9pZCBhbmQgI3N0YXNoLmNhbXBhaWduX2lkID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBzdGFzaC5jYW1wYWlnbl9pZCcpCiAgZW5kCgogIGlmIG5vdCAoc3Rhc2gubWlycm9yX2RvbWFpbiBhbmQgI3N0YXNoLm1pcnJvcl9kb21haW4gPiAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIHN0YXNoLm1pcnJvcl9kb21haW4nKQogIGVuZAoKICAtLSBQb2ludCBvZiBubyByZXR1cm4KCiAgcmVkaXMuY2FsbCgnREVMJywgY2FtcGFpZ25fa2V5KQoKICByZWRpcy5jYWxsKCdTUkVNJywgY2FtcGFpZ25fdW5pcXVlX21pcnJvcl9kb21haW5fa2V5LCBzdGFzaC5taXJyb3JfZG9tYWluKQoKICByZWRpcy5jYWxsKCdaUkVNJywgY2FtcGFpZ25faW5kZXhfa2V5LCBzdGFzaC5jYW1wYWlnbl9pZCkKCiAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnT0sgQ2FtcGFpZ24gZGVsZXRlZCcpCmVuZAoKcmVkaXMucmVnaXN0ZXJfZnVuY3Rpb24oewogIGZ1bmN0aW9uX25hbWUgPSAnZGVsZXRlX2NhbXBhaWduJywKICBjYWxsYmFjayA9IGRlbGV0ZV9jYW1wYWlnbiwKICBkZXNjcmlwdGlvbiA9ICdEZWxldGUgY2FtcGFpZ24nLAp9KQo=`,

  // 2-proxy.lua
  `IyFsdWEgbmFtZT1wcm94eQoKLS1bWwogIENyZWF0ZSBwcm94eQotLV1dCmxvY2FsIGZ1bmN0aW9uIGNyZWF0ZV9wcm94eShrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gNCBhbmQgI2FyZ3MgPT0gNCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgZnVuY3Rpb24gdXNlJykKICBlbmQKCiAgbG9jYWwgY2FtcGFpZ25fa2V5ID0ga2V5c1sxXQogIGxvY2FsIHByb3h5X2tleSA9IGtleXNbMl0KICBsb2NhbCBwcm94eV91bmlxdWVfdXJsX2tleSA9IGtleXNbM10KICBsb2NhbCBwcm94eV9pbmRleF9rZXkgPSBrZXlzWzRdCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgY2FtcGFpZ25fa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdOT1RfRk9VTkQgQ2FtcGFpZ24gbm90IGZvdW5kJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBwcm94eV9rZXkpID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ0NPTkZMSUNUIFByb3h5IGFsbHJlYWR5IGV4aXN0cycpCiAgZW5kCgogIGxvY2FsIG1vZGVsID0gewogICAgY2FtcGFpZ25faWQgPSBhcmdzWzFdLAogICAgcHJveHlfaWQgPSBhcmdzWzJdLAogICAgdXJsID0gYXJnc1szXSwKICAgIGlzX2VuYWJsZWQgPSAwLAogICAgbWVzc2FnZV9jb3VudCA9IDAsCiAgICBjcmVhdGVkX2F0ID0gdG9udW1iZXIoYXJnc1s0XSksCiAgICB1cGRhdGVkX2F0ID0gdG9udW1iZXIoYXJnc1s0XSksCiAgfQoKICBmb3IgZmllbGQsIHZhbHVlIGluIHBhaXJzKG1vZGVsKSBkbwogICAgaWYgbm90IHZhbHVlIHRoZW4KICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwuJyAuLiBmaWVsZCkKICAgIGVuZAogIGVuZAoKICBpZiBub3QgKCNtb2RlbC5jYW1wYWlnbl9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLmNhbXBhaWduX2lkJykKICBlbmQKCiAgaWYgbm90ICgjbW9kZWwucHJveHlfaWQgPiAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBtb2RlbC5wcm94eV9pZCcpCiAgZW5kCgogIGlmIG5vdCAoI21vZGVsLnVybCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLnVybCcpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnU0lTTUVNQkVSJywgcHJveHlfdW5pcXVlX3VybF9rZXksIG1vZGVsLnVybCkgPT0gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnQ09ORkxJQ1QgUHJveHkgdXJsIGFsbHJlYWR5IHRha2VuJykKICBlbmQKCiAgLS0gUG9pbnQgb2Ygbm8gcmV0dXJuCgogIGxvY2FsIHN0b3JlID0ge30KCiAgZm9yIGZpZWxkLCB2YWx1ZSBpbiBwYWlycyhtb2RlbCkgZG8KICAgIHRhYmxlLmluc2VydChzdG9yZSwgZmllbGQpCiAgICB0YWJsZS5pbnNlcnQoc3RvcmUsIHZhbHVlKQogIGVuZAoKICByZWRpcy5jYWxsKCdIU0VUJywgcHJveHlfa2V5LCB1bnBhY2soc3RvcmUpKQoKICByZWRpcy5jYWxsKCdTQUREJywgcHJveHlfdW5pcXVlX3VybF9rZXksIG1vZGVsLnVybCkKCiAgcmVkaXMuY2FsbCgnWkFERCcsIHByb3h5X2luZGV4X2tleSwgbW9kZWwuY3JlYXRlZF9hdCwgbW9kZWwucHJveHlfaWQpCgogIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ09LIFByb3h5IGNyZWF0ZWQnKQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ2NyZWF0ZV9wcm94eScsCiAgY2FsbGJhY2sgPSBjcmVhdGVfcHJveHksCiAgZGVzY3JpcHRpb24gPSAnQ3JlYXRlIHByb3h5JywKfSkKCi0tW1sKICBSZWFkIHByb3h5Ci0tXV0KbG9jYWwgZnVuY3Rpb24gcmVhZF9wcm94eShrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gMiBhbmQgI2FyZ3MgPT0gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgZnVuY3Rpb24gdXNlJykKICBlbmQKCiAgbG9jYWwgY2FtcGFpZ25fa2V5ID0ga2V5c1sxXQogIGxvY2FsIHByb3h5X2tleSA9IGtleXNbMl0KCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBjYW1wYWlnbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiBuaWwKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBwcm94eV9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiBuaWwKICBlbmQKCiAgLS0gc3R5bHVhOiBpZ25vcmUKICBsb2NhbCB2YWx1ZXMgPSByZWRpcy5jYWxsKAogICAgJ0hNR0VUJywgcHJveHlfa2V5LAogICAgJ2NhbXBhaWduX2lkJywKICAgICdwcm94eV9pZCcsCiAgICAndXJsJywKICAgICdpc19lbmFibGVkJywKICAgICdtZXNzYWdlX2NvdW50JywKICAgICdjcmVhdGVkX2F0JywKICAgICd1cGRhdGVkX2F0JwogICkKCiAgaWYgbm90ICgjdmFsdWVzID09IDcpIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gdmFsdWVzJykKICBlbmQKCiAgbG9jYWwgbW9kZWwgPSB7CiAgICBjYW1wYWlnbl9pZCA9IHZhbHVlc1sxXSwKICAgIHByb3h5X2lkID0gdmFsdWVzWzJdLAogICAgdXJsID0gdmFsdWVzWzNdLAogICAgaXNfZW5hYmxlZCA9IHRvbnVtYmVyKHZhbHVlc1s0XSksCiAgICBtZXNzYWdlX2NvdW50ID0gdG9udW1iZXIodmFsdWVzWzVdKSwKICAgIGNyZWF0ZWRfYXQgPSB0b251bWJlcih2YWx1ZXNbNl0pLAogICAgdXBkYXRlZF9hdCA9IHRvbnVtYmVyKHZhbHVlc1s3XSksCiAgfQoKICBmb3IgZmllbGQsIHZhbHVlIGluIHBhaXJzKG1vZGVsKSBkbwogICAgaWYgbm90IHZhbHVlIHRoZW4KICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBtb2RlbC4nIC4uIGZpZWxkKQogICAgZW5kCiAgZW5kCgogIHJldHVybiB7IG1hcCA9IG1vZGVsIH0KZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICdyZWFkX3Byb3h5JywKICBjYWxsYmFjayA9IHJlYWRfcHJveHksCiAgZmxhZ3MgPSB7ICduby13cml0ZXMnIH0sCiAgZGVzY3JpcHRpb24gPSAnUmVhZCBwcm94eScsCn0pCgotLVtbCiAgUmVhZCBwcm94eSBpbmRleAotLV1dCmxvY2FsIGZ1bmN0aW9uIHJlYWRfcHJveHlfaW5kZXgoa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDIgYW5kICNhcmdzID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCBwcm94eV9pbmRleF9rZXkgPSBrZXlzWzJdCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgY2FtcGFpZ25fa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gbmlsCiAgZW5kCgogIHJldHVybiByZWRpcy5jYWxsKCdaUkFOR0UnLCBwcm94eV9pbmRleF9rZXksIDAsIC0xKQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ3JlYWRfcHJveHlfaW5kZXgnLAogIGNhbGxiYWNrID0gcmVhZF9wcm94eV9pbmRleCwKICBmbGFncyA9IHsgJ25vLXdyaXRlcycgfSwKICBkZXNjcmlwdGlvbiA9ICdSZWFkIHByb3h5IGluZGV4JywKfSkKCi0tW1sKICBFbmFibGUgcHJveHkKLS1dXQpsb2NhbCBmdW5jdGlvbiBlbmFibGVfcHJveHkoa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDMgYW5kICNhcmdzID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCBwcm94eV9rZXkgPSBrZXlzWzJdCiAgbG9jYWwgZW5hYmxlZF9wcm94eV9pbmRleF9rZXkgPSBrZXlzWzNdCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgY2FtcGFpZ25fa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdOT1RfRk9VTkQgQ2FtcGFpZ24gbm90IGZvdW5kJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBwcm94eV9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBQcm94eSBub3QgZm91bmQnKQogIGVuZAoKICBsb2NhbCBzdGFzaCA9IHsKICAgIHVwZGF0ZWRfYXQgPSB0b251bWJlcihhcmdzWzFdKSwKICAgIHByb3h5X2lkID0gcmVkaXMuY2FsbCgnSEdFVCcsIHByb3h5X2tleSwgJ3Byb3h5X2lkJyksCiAgICBpc19lbmFibGVkID0gdG9udW1iZXIocmVkaXMuY2FsbCgnSEdFVCcsIHByb3h5X2tleSwgJ2lzX2VuYWJsZWQnKSksCiAgfQoKICBpZiBub3Qgc3Rhc2gudXBkYXRlZF9hdCB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBzdGFzaC51cGRhdGVkX2F0JykKICBlbmQKCiAgaWYgbm90IChzdGFzaC5wcm94eV9pZCBhbmQgI3N0YXNoLnByb3h5X2lkID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBzdGFzaC5wcm94eV9pZCcpCiAgZW5kCgogIGlmIG5vdCBzdGFzaC5pc19lbmFibGVkIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gc3Rhc2guaXNfZW5hYmxlZCcpCiAgZW5kCgogIGlmIHN0YXNoLmlzX2VuYWJsZWQgfj0gMCB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBQcm94eSBhbGxyZWFkeSBlbmFibGVkJykKICBlbmQKCiAgLS0gUG9pbnQgb2Ygbm8gcmV0dXJuCgogIC0tIHN0eWx1YTogaWdub3JlCiAgcmVkaXMuY2FsbCgKICAgICdIU0VUJywgcHJveHlfa2V5LAogICAgJ2lzX2VuYWJsZWQnLCAxLAogICAgJ3VwZGF0ZWRfYXQnLCBzdGFzaC51cGRhdGVkX2F0CiAgKQoKICByZWRpcy5jYWxsKCdTQUREJywgZW5hYmxlZF9wcm94eV9pbmRleF9rZXksIHN0YXNoLnByb3h5X2lkKQoKICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBQcm94eSBlbmFibGVkJykKZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICdlbmFibGVfcHJveHknLAogIGNhbGxiYWNrID0gZW5hYmxlX3Byb3h5LAogIGRlc2NyaXB0aW9uID0gJ0VuYWJsZSBwcm94eScsCn0pCgotLVtbCiAgRGlzYWJsZSBwcm94eQotLV1dCmxvY2FsIGZ1bmN0aW9uIGRpc2FibGVfcHJveHkoa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDMgYW5kICNhcmdzID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCBwcm94eV9rZXkgPSBrZXlzWzJdCiAgbG9jYWwgZW5hYmxlZF9wcm94eV9pbmRleF9rZXkgPSBrZXlzWzNdCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgY2FtcGFpZ25fa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdOT1RfRk9VTkQgQ2FtcGFpZ24gbm90IGZvdW5kJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBwcm94eV9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBQcm94eSBub3QgZm91bmQnKQogIGVuZAoKICBsb2NhbCBzdGFzaCA9IHsKICAgIHVwZGF0ZWRfYXQgPSB0b251bWJlcihhcmdzWzFdKSwKICAgIHByb3h5X2lkID0gcmVkaXMuY2FsbCgnSEdFVCcsIHByb3h5X2tleSwgJ3Byb3h5X2lkJyksCiAgICBpc19lbmFibGVkID0gdG9udW1iZXIocmVkaXMuY2FsbCgnSEdFVCcsIHByb3h5X2tleSwgJ2lzX2VuYWJsZWQnKSksCiAgfQoKICBpZiBub3Qgc3Rhc2gudXBkYXRlZF9hdCB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBzdGFzaC51cGRhdGVkX2F0JykKICBlbmQKCiAgaWYgbm90IChzdGFzaC5wcm94eV9pZCBhbmQgI3N0YXNoLnByb3h5X2lkID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBzdGFzaC5wcm94eV9pZCcpCiAgZW5kCgogIGlmIG5vdCBzdGFzaC5pc19lbmFibGVkIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gc3Rhc2guaXNfZW5hYmxlZCcpCiAgZW5kCgogIGlmIHN0YXNoLmlzX2VuYWJsZWQgPT0gMCB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBQcm94eSBhbGxyZWFkeSBkaXNhYmxlZCcpCiAgZW5kCgogIC0tIFBvaW50IG9mIG5vIHJldHVybgoKICAtLSBzdHlsdWE6IGlnbm9yZQogIHJlZGlzLmNhbGwoCiAgICAnSFNFVCcsIHByb3h5X2tleSwKICAgICdpc19lbmFibGVkJywgMCwKICAgICd1cGRhdGVkX2F0Jywgc3Rhc2gudXBkYXRlZF9hdAogICkKCiAgcmVkaXMuY2FsbCgnU1JFTScsIGVuYWJsZWRfcHJveHlfaW5kZXhfa2V5LCBzdGFzaC5wcm94eV9pZCkKCiAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnT0sgUHJveHkgZGlzYWJsZWQnKQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ2Rpc2FibGVfcHJveHknLAogIGNhbGxiYWNrID0gZGlzYWJsZV9wcm94eSwKICBkZXNjcmlwdGlvbiA9ICdEaXNhYmxlIHByb3h5JywKfSkKCi0tW1sKICBEZWxldGUgcHJveHkKLS1dXQpsb2NhbCBmdW5jdGlvbiBkZWxldGVfcHJveHkoa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDQgYW5kICNhcmdzID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCBwcm94eV9rZXkgPSBrZXlzWzJdCiAgbG9jYWwgcHJveHlfdW5pcXVlX3VybF9rZXkgPSBrZXlzWzNdCiAgbG9jYWwgcHJveHlfaW5kZXhfa2V5ID0ga2V5c1s0XQoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGNhbXBhaWduX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIENhbXBhaWduIG5vdCBmb3VuZCcpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgcHJveHlfa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdOT1RfRk9VTkQgUHJveHkgbm90IGZvdW5kJykKICBlbmQKCiAgbG9jYWwgc3Rhc2ggPSB7CiAgICBwcm94eV9pZCA9IHJlZGlzLmNhbGwoJ0hHRVQnLCBwcm94eV9rZXksICdwcm94eV9pZCcpLAogICAgdXJsID0gcmVkaXMuY2FsbCgnSEdFVCcsIHByb3h5X2tleSwgJ3VybCcpLAogICAgaXNfZW5hYmxlZCA9IHRvbnVtYmVyKHJlZGlzLmNhbGwoJ0hHRVQnLCBwcm94eV9rZXksICdpc19lbmFibGVkJykpLAogIH0KCiAgaWYgbm90IChzdGFzaC5wcm94eV9pZCBhbmQgI3N0YXNoLnByb3h5X2lkID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBzdGFzaC5wcm94eV9pZCcpCiAgZW5kCgogIGlmIG5vdCAoc3Rhc2gudXJsIGFuZCAjc3Rhc2gudXJsID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBzdGFzaC51cmwnKQogIGVuZAoKICBpZiBub3Qgc3Rhc2guaXNfZW5hYmxlZCB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIHN0YXNoLmlzX2VuYWJsZWQnKQogIGVuZAoKICBpZiBzdGFzaC5pc19lbmFibGVkIH49IDAgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnRk9SQklEREVOIFByb3h5IG5vdCBkaXNhYmxlZCcpCiAgZW5kCgogIC0tIFBvaW50IG9mIG5vIHJldHVybgoKICByZWRpcy5jYWxsKCdERUwnLCBwcm94eV9rZXkpCgogIHJlZGlzLmNhbGwoJ1NSRU0nLCBwcm94eV91bmlxdWVfdXJsX2tleSwgc3Rhc2gudXJsKQoKICByZWRpcy5jYWxsKCdaUkVNJywgcHJveHlfaW5kZXhfa2V5LCBzdGFzaC5wcm94eV9pZCkKCiAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnT0sgUHJveHkgZGVsZXRlZCcpCmVuZAoKcmVkaXMucmVnaXN0ZXJfZnVuY3Rpb24oewogIGZ1bmN0aW9uX25hbWUgPSAnZGVsZXRlX3Byb3h5JywKICBjYWxsYmFjayA9IGRlbGV0ZV9wcm94eSwKICBkZXNjcmlwdGlvbiA9ICdEZWxldGUgcHJveHknLAp9KQo=`,

  // 3-target.lua
  `IyFsdWEgbmFtZT10YXJnZXQKCi0tW1sKICBDcmVhdGUgdGFyZ2V0Ci0tXV0KbG9jYWwgZnVuY3Rpb24gY3JlYXRlX3RhcmdldChrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gNSBhbmQgI2FyZ3MgPT0gMjEpIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCB0YXJnZXRfa2V5ID0ga2V5c1syXQogIGxvY2FsIHRhcmdldF91bmlxdWVfZG9ub3Jfa2V5ID0ga2V5c1szXQogIGxvY2FsIHRhcmdldF91bmlxdWVfbWlycm9yX2tleSA9IGtleXNbNF0KICBsb2NhbCB0YXJnZXRfaW5kZXhfa2V5ID0ga2V5c1s1XQoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGNhbXBhaWduX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIENhbXBhaWduIG5vdCBmb3VuZCcpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgdGFyZ2V0X2tleSkgPT0gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnQ09ORkxJQ1QgVGFyZ2V0IGFsbHJlYWR5IGV4aXN0cycpCiAgZW5kCgogIGxvY2FsIG1vZGVsID0gewogICAgY2FtcGFpZ25faWQgPSBhcmdzWzFdLAogICAgdGFyZ2V0X2lkID0gYXJnc1syXSwKICAgIGlzX2xhbmRpbmcgPSB0b251bWJlcihhcmdzWzNdKSwKICAgIGRvbm9yX3NlY3VyZSA9IHRvbnVtYmVyKGFyZ3NbNF0pLAogICAgZG9ub3Jfc3ViID0gYXJnc1s1XSwKICAgIGRvbm9yX2RvbWFpbiA9IGFyZ3NbNl0sCiAgICBkb25vcl9wb3J0ID0gdG9udW1iZXIoYXJnc1s3XSksCiAgICBtaXJyb3Jfc2VjdXJlID0gdG9udW1iZXIoYXJnc1s4XSksCiAgICBtaXJyb3Jfc3ViID0gYXJnc1s5XSwKICAgIG1pcnJvcl9wb3J0ID0gdG9udW1iZXIoYXJnc1sxMF0pLAogICAgY29ubmVjdF90aW1lb3V0ID0gdG9udW1iZXIoYXJnc1sxMV0pLAogICAgb3JkaW5hcnlfdGltZW91dCA9IHRvbnVtYmVyKGFyZ3NbMTJdKSwKICAgIHN0cmVhbWluZ190aW1lb3V0ID0gdG9udW1iZXIoYXJnc1sxM10pLAogICAgcmVxdWVzdF9ib2R5X2xpbWl0ID0gdG9udW1iZXIoYXJnc1sxNF0pLAogICAgcmVzcG9uc2VfYm9keV9saW1pdCA9IHRvbnVtYmVyKGFyZ3NbMTVdKSwKICAgIG1haW5fcGFnZSA9IGFyZ3NbMTZdLAogICAgbm90X2ZvdW5kX3BhZ2UgPSBhcmdzWzE3XSwKICAgIGZhdmljb25faWNvID0gYXJnc1sxOF0sCiAgICByb2JvdHNfdHh0ID0gYXJnc1sxOV0sCiAgICBzaXRlbWFwX3htbCA9IGFyZ3NbMjBdLAogICAgaXNfZW5hYmxlZCA9IDAsCiAgICBtZXNzYWdlX2NvdW50ID0gMCwKICAgIGNyZWF0ZWRfYXQgPSB0b251bWJlcihhcmdzWzIxXSksCiAgICB1cGRhdGVkX2F0ID0gdG9udW1iZXIoYXJnc1syMV0pLAogIH0KCiAgZm9yIGZpZWxkLCB2YWx1ZSBpbiBwYWlycyhtb2RlbCkgZG8KICAgIGlmIG5vdCB2YWx1ZSB0aGVuCiAgICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLicgLi4gZmllbGQpCiAgICBlbmQKICBlbmQKCiAgaWYgbm90ICgjbW9kZWwuY2FtcGFpZ25faWQgPiAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBtb2RlbC5jYW1wYWlnbl9pZCcpCiAgZW5kCgogIGlmIG5vdCAoI21vZGVsLnRhcmdldF9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLnRhcmdldF9pZCcpCiAgZW5kCgogIGlmIG5vdCAoI21vZGVsLmRvbm9yX3N1YiA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnV3JvbmcgbW9kZWwuZG9ub3Jfc3ViJykKICBlbmQKCiAgaWYgbm90ICgjbW9kZWwuZG9ub3JfZG9tYWluID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwuZG9ub3JfZG9tYWluJykKICBlbmQKCiAgaWYgbm90IChtb2RlbC5kb25vcl9wb3J0ID49IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLmRvbm9yX3BvcnQnKQogIGVuZAoKICBpZiBub3QgKCNtb2RlbC5taXJyb3Jfc3ViID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwubWlycm9yX3N1YicpCiAgZW5kCgogIGlmIG5vdCAobW9kZWwubWlycm9yX3BvcnQgPj0gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwubWlycm9yX3BvcnQnKQogIGVuZAoKICAtLSBzdHlsdWE6IGlnbm9yZQogIGxvY2FsIGRvbm9yID0gbW9kZWwuY2FtcGFpZ25faWQKICAgIC4uICdcdCcgLi4gbW9kZWwuZG9ub3Jfc3ViCiAgICAuLiAnXHQnIC4uIG1vZGVsLmRvbm9yX2RvbWFpbgogICAgLi4gJ1x0JyAuLiB0b3N0cmluZyhtb2RlbC5kb25vcl9wb3J0KQoKICAtLSBzdHlsdWE6IGlnbm9yZQogIGxvY2FsIG1pcnJvciA9IG1vZGVsLmNhbXBhaWduX2lkCiAgICAuLiAnXHQnIC4uIG1vZGVsLm1pcnJvcl9zdWIKICAgIC4uICdcdCcgLi4gdG9zdHJpbmcobW9kZWwubWlycm9yX3BvcnQpCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnU0lTTUVNQkVSJywgdGFyZ2V0X3VuaXF1ZV9kb25vcl9rZXksIGRvbm9yKSA9PSAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdDT05GTElDVCBUYXJnZXQgZG9ub3IgYWxscmVhZHkgdGFrZW4nKQogIGVuZAoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ1NJU01FTUJFUicsIHRhcmdldF91bmlxdWVfbWlycm9yX2tleSwgbWlycm9yKSA9PSAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdDT05GTElDVCBUYXJnZXQgbWlycm9yIGFsbHJlYWR5IHRha2VuJykKICBlbmQKCiAgLS0gUG9pbnQgb2Ygbm8gcmV0dXJuCgogIGxvY2FsIHN0b3JlID0ge30KCiAgZm9yIGZpZWxkLCB2YWx1ZSBpbiBwYWlycyhtb2RlbCkgZG8KICAgIHRhYmxlLmluc2VydChzdG9yZSwgZmllbGQpCiAgICB0YWJsZS5pbnNlcnQoc3RvcmUsIHZhbHVlKQogIGVuZAoKICByZWRpcy5jYWxsKCdIU0VUJywgdGFyZ2V0X2tleSwgdW5wYWNrKHN0b3JlKSkKCiAgcmVkaXMuY2FsbCgnU0FERCcsIHRhcmdldF91bmlxdWVfZG9ub3Jfa2V5LCBkb25vcikKICByZWRpcy5jYWxsKCdTQUREJywgdGFyZ2V0X3VuaXF1ZV9taXJyb3Jfa2V5LCBtaXJyb3IpCgogIHJlZGlzLmNhbGwoJ1pBREQnLCB0YXJnZXRfaW5kZXhfa2V5LCBtb2RlbC5jcmVhdGVkX2F0LCBtb2RlbC50YXJnZXRfaWQpCgogIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ09LIFRhcmdldCBjcmVhdGVkJykKZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICdjcmVhdGVfdGFyZ2V0JywKICBjYWxsYmFjayA9IGNyZWF0ZV90YXJnZXQsCiAgZGVzY3JpcHRpb24gPSAnQ3JlYXRlIHRhcmdldCcsCn0pCgotLVtbCiAgUmVhZCB0YXJnZXQKLS1dXQpsb2NhbCBmdW5jdGlvbiByZWFkX3RhcmdldChrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gMiBhbmQgI2FyZ3MgPT0gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgZnVuY3Rpb24gdXNlJykKICBlbmQKCiAgbG9jYWwgY2FtcGFpZ25fa2V5ID0ga2V5c1sxXQogIGxvY2FsIHRhcmdldF9rZXkgPSBrZXlzWzJdCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgY2FtcGFpZ25fa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gbmlsCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgdGFyZ2V0X2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIG5pbAogIGVuZAoKICAtLSBzdHlsdWE6IGlnbm9yZQogIGxvY2FsIHZhbHVlcyA9IHJlZGlzLmNhbGwoCiAgICAnSE1HRVQnLCB0YXJnZXRfa2V5LAogICAgJ2NhbXBhaWduX2lkJywKICAgICd0YXJnZXRfaWQnLAogICAgJ2lzX2xhbmRpbmcnLAogICAgJ2Rvbm9yX3NlY3VyZScsCiAgICAnZG9ub3Jfc3ViJywKICAgICdkb25vcl9kb21haW4nLAogICAgJ2Rvbm9yX3BvcnQnLAogICAgJ21pcnJvcl9zZWN1cmUnLAogICAgJ21pcnJvcl9zdWInLAogICAgJ21pcnJvcl9wb3J0JywKICAgICdpc19lbmFibGVkJywKICAgICdtZXNzYWdlX2NvdW50JywKICAgICdjcmVhdGVkX2F0JywKICAgICd1cGRhdGVkX2F0JwogICkKCiAgaWYgbm90ICgjdmFsdWVzID09IDE0KSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIHZhbHVlcycpCiAgZW5kCgogIGxvY2FsIG1vZGVsID0gewogICAgY2FtcGFpZ25faWQgPSB2YWx1ZXNbMV0sCiAgICB0YXJnZXRfaWQgPSB2YWx1ZXNbMl0sCiAgICBpc19sYW5kaW5nID0gdG9udW1iZXIodmFsdWVzWzNdKSwKICAgIGRvbm9yX3NlY3VyZSA9IHRvbnVtYmVyKHZhbHVlc1s0XSksCiAgICBkb25vcl9zdWIgPSB2YWx1ZXNbNV0sCiAgICBkb25vcl9kb21haW4gPSB2YWx1ZXNbNl0sCiAgICBkb25vcl9wb3J0ID0gdG9udW1iZXIodmFsdWVzWzddKSwKICAgIG1pcnJvcl9zZWN1cmUgPSB0b251bWJlcih2YWx1ZXNbOF0pLAogICAgbWlycm9yX3N1YiA9IHZhbHVlc1s5XSwKICAgIG1pcnJvcl9wb3J0ID0gdmFsdWVzWzEwXSwKICAgIGlzX2VuYWJsZWQgPSB0b251bWJlcih2YWx1ZXNbMTFdKSwKICAgIG1lc3NhZ2VfY291bnQgPSB0b251bWJlcih2YWx1ZXNbMTJdKSwKICAgIGNyZWF0ZWRfYXQgPSB0b251bWJlcih2YWx1ZXNbMTNdKSwKICAgIHVwZGF0ZWRfYXQgPSB0b251bWJlcih2YWx1ZXNbMTRdKSwKICB9CgogIGZvciBmaWVsZCwgdmFsdWUgaW4gcGFpcnMobW9kZWwpIGRvCiAgICBpZiBub3QgdmFsdWUgdGhlbgogICAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIG1vZGVsLicgLi4gZmllbGQpCiAgICBlbmQKICBlbmQKCiAgcmV0dXJuIHsgbWFwID0gbW9kZWwgfQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ3JlYWRfdGFyZ2V0JywKICBjYWxsYmFjayA9IHJlYWRfdGFyZ2V0LAogIGZsYWdzID0geyAnbm8td3JpdGVzJyB9LAogIGRlc2NyaXB0aW9uID0gJ1JlYWQgdGFyZ2V0JywKfSkKCi0tW1sKICBSZWFkIGZ1bGwgdGFyZ2V0Ci0tXV0KbG9jYWwgZnVuY3Rpb24gcmVhZF9mdWxsX3RhcmdldChrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gMyBhbmQgI2FyZ3MgPT0gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgZnVuY3Rpb24gdXNlJykKICBlbmQKCiAgbG9jYWwgY2FtcGFpZ25fa2V5ID0ga2V5c1sxXQogIGxvY2FsIHRhcmdldF9rZXkgPSBrZXlzWzJdCiAgbG9jYWwgdGFyZ2V0X2xhYmVsc19rZXkgPSBrZXlzWzNdCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgY2FtcGFpZ25fa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gbmlsCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgdGFyZ2V0X2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIG5pbAogIGVuZAoKICAtLSBzdHlsdWE6IGlnbm9yZQogIGxvY2FsIHZhbHVlcyA9IHJlZGlzLmNhbGwoCiAgICAnSE1HRVQnLCB0YXJnZXRfa2V5LAogICAgJ2NhbXBhaWduX2lkJywKICAgICd0YXJnZXRfaWQnLAogICAgJ2lzX2xhbmRpbmcnLAogICAgJ2Rvbm9yX3NlY3VyZScsCiAgICAnZG9ub3Jfc3ViJywKICAgICdkb25vcl9kb21haW4nLAogICAgJ2Rvbm9yX3BvcnQnLAogICAgJ21pcnJvcl9zZWN1cmUnLAogICAgJ21pcnJvcl9zdWInLAogICAgJ21pcnJvcl9wb3J0JywKICAgICdjb25uZWN0X3RpbWVvdXQnLAogICAgJ29yZGluYXJ5X3RpbWVvdXQnLAogICAgJ3N0cmVhbWluZ190aW1lb3V0JywKICAgICdyZXF1ZXN0X2JvZHlfbGltaXQnLAogICAgJ3Jlc3BvbnNlX2JvZHlfbGltaXQnLAogICAgJ21haW5fcGFnZScsCiAgICAnbm90X2ZvdW5kX3BhZ2UnLAogICAgJ2Zhdmljb25faWNvJywKICAgICdyb2JvdHNfdHh0JywKICAgICdzaXRlbWFwX3htbCcsCiAgICAnaXNfZW5hYmxlZCcsCiAgICAnbWVzc2FnZV9jb3VudCcsCiAgICAnY3JlYXRlZF9hdCcsCiAgICAndXBkYXRlZF9hdCcKICApCgogIGlmIG5vdCAoI3ZhbHVlcyA9PSAyNCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSB2YWx1ZXMnKQogIGVuZAoKICBsb2NhbCBtb2RlbCA9IHsKICAgIGNhbXBhaWduX2lkID0gdmFsdWVzWzFdLAogICAgdGFyZ2V0X2lkID0gdmFsdWVzWzJdLAogICAgaXNfbGFuZGluZyA9IHRvbnVtYmVyKHZhbHVlc1szXSksCiAgICBkb25vcl9zZWN1cmUgPSB0b251bWJlcih2YWx1ZXNbNF0pLAogICAgZG9ub3Jfc3ViID0gdmFsdWVzWzVdLAogICAgZG9ub3JfZG9tYWluID0gdmFsdWVzWzZdLAogICAgZG9ub3JfcG9ydCA9IHRvbnVtYmVyKHZhbHVlc1s3XSksCiAgICBtaXJyb3Jfc2VjdXJlID0gdG9udW1iZXIodmFsdWVzWzhdKSwKICAgIG1pcnJvcl9zdWIgPSB2YWx1ZXNbOV0sCiAgICBtaXJyb3JfcG9ydCA9IHRvbnVtYmVyKHZhbHVlc1sxMF0pLAogICAgbGFiZWxzID0gcmVkaXMuY2FsbCgnU01FTUJFUlMnLCB0YXJnZXRfbGFiZWxzX2tleSksCiAgICBjb25uZWN0X3RpbWVvdXQgPSB0b251bWJlcih2YWx1ZXNbMTFdKSwKICAgIG9yZGluYXJ5X3RpbWVvdXQgPSB0b251bWJlcih2YWx1ZXNbMTJdKSwKICAgIHN0cmVhbWluZ190aW1lb3V0ID0gdG9udW1iZXIodmFsdWVzWzEzXSksCiAgICByZXF1ZXN0X2JvZHlfbGltaXQgPSB0b251bWJlcih2YWx1ZXNbMTRdKSwKICAgIHJlc3BvbnNlX2JvZHlfbGltaXQgPSB0b251bWJlcih2YWx1ZXNbMTVdKSwKICAgIG1haW5fcGFnZSA9IHZhbHVlc1sxNl0sCiAgICBub3RfZm91bmRfcGFnZSA9IHZhbHVlc1sxN10sCiAgICBmYXZpY29uX2ljbyA9IHZhbHVlc1sxOF0sCiAgICByb2JvdHNfdHh0ID0gdmFsdWVzWzE5XSwKICAgIHNpdGVtYXBfeG1sID0gdmFsdWVzWzIwXSwKICAgIGlzX2VuYWJsZWQgPSB0b251bWJlcih2YWx1ZXNbMjFdKSwKICAgIG1lc3NhZ2VfY291bnQgPSB0b251bWJlcih2YWx1ZXNbMjJdKSwKICAgIGNyZWF0ZWRfYXQgPSB0b251bWJlcih2YWx1ZXNbMjNdKSwKICAgIHVwZGF0ZWRfYXQgPSB0b251bWJlcih2YWx1ZXNbMjRdKSwKICB9CgogIGZvciBmaWVsZCwgdmFsdWUgaW4gcGFpcnMobW9kZWwpIGRvCiAgICBpZiBub3QgdmFsdWUgdGhlbgogICAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIG1vZGVsLicgLi4gZmllbGQpCiAgICBlbmQKICBlbmQKCiAgcmV0dXJuIHsgbWFwID0gbW9kZWwgfQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ3JlYWRfZnVsbF90YXJnZXQnLAogIGNhbGxiYWNrID0gcmVhZF9mdWxsX3RhcmdldCwKICBmbGFncyA9IHsgJ25vLXdyaXRlcycgfSwKICBkZXNjcmlwdGlvbiA9ICdSZWFkIGZ1bGwgdGFyZ2V0JywKfSkKCi0tW1sKICBSZWFkIHRhcmdldCBpbmRleAotLV1dCmxvY2FsIGZ1bmN0aW9uIHJlYWRfdGFyZ2V0X2luZGV4KGtleXMsIGFyZ3MpCiAgaWYgbm90ICgja2V5cyA9PSAyIGFuZCAjYXJncyA9PSAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBmdW5jdGlvbiB1c2UnKQogIGVuZAoKICBsb2NhbCBjYW1wYWlnbl9rZXkgPSBrZXlzWzFdCiAgbG9jYWwgdGFyZ2V0X2luZGV4X2tleSA9IGtleXNbMl0KCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBjYW1wYWlnbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiBuaWwKICBlbmQKCiAgcmV0dXJuIHJlZGlzLmNhbGwoJ1pSQU5HRScsIHRhcmdldF9pbmRleF9rZXksIDAsIC0xKQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ3JlYWRfdGFyZ2V0X2luZGV4JywKICBjYWxsYmFjayA9IHJlYWRfdGFyZ2V0X2luZGV4LAogIGZsYWdzID0geyAnbm8td3JpdGVzJyB9LAogIGRlc2NyaXB0aW9uID0gJ1JlYWQgdGFyZ2V0IGluZGV4JywKfSkKCi0tW1sKICBVcGRhdGUgdGFyZ2V0Ci0tXV0KbG9jYWwgZnVuY3Rpb24gdXBkYXRlX3RhcmdldChrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gMiBhbmQgI2FyZ3MgPj0gMCBhbmQgI2FyZ3MgJSAyID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCB0YXJnZXRfa2V5ID0ga2V5c1syXQoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGNhbXBhaWduX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIENhbXBhaWduIG5vdCBmb3VuZCcpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgdGFyZ2V0X2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIFRhcmdldCBub3QgZm91bmQnKQogIGVuZAoKICBsb2NhbCBtb2RlbCA9IHt9CgogIGZvciBpID0gMSwgI2FyZ3MsIDIgZG8KICAgIGxvY2FsIGZpZWxkLCB2YWx1ZSA9IGFyZ3NbaV0sIGFyZ3NbaSArIDFdCgogICAgaWYgbW9kZWxbZmllbGRdIHRoZW4KICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgRHVwbGljYXRlIG1vZGVsLicgLi4gZmllbGQpCiAgICBlbmQKCiAgICBpZiBmaWVsZCA9PSAnY29ubmVjdF90aW1lb3V0JyB0aGVuCiAgICAgIG1vZGVsLmNvbm5lY3RfdGltZW91dCA9IHRvbnVtYmVyKHZhbHVlKQoKICAgICAgaWYgbm90IG1vZGVsLmNvbm5lY3RfdGltZW91dCB0aGVuCiAgICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwuY29ubmVjdF90aW1lb3V0JykKICAgICAgZW5kCiAgICBlbHNlaWYgZmllbGQgPT0gJ29yZGluYXJ5X3RpbWVvdXQnIHRoZW4KICAgICAgbW9kZWwub3JkaW5hcnlfdGltZW91dCA9IHRvbnVtYmVyKHZhbHVlKQoKICAgICAgaWYgbm90IG1vZGVsLm9yZGluYXJ5X3RpbWVvdXQgdGhlbgogICAgICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLm9yZGluYXJ5X3RpbWVvdXQnKQogICAgICBlbmQKICAgIGVsc2VpZiBmaWVsZCA9PSAnc3RyZWFtaW5nX3RpbWVvdXQnIHRoZW4KICAgICAgbW9kZWwuc3RyZWFtaW5nX3RpbWVvdXQgPSB0b251bWJlcih2YWx1ZSkKCiAgICAgIGlmIG5vdCBtb2RlbC5zdHJlYW1pbmdfdGltZW91dCB0aGVuCiAgICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwuc3RyZWFtaW5nX3RpbWVvdXQnKQogICAgICBlbmQKICAgIGVsc2VpZiBmaWVsZCA9PSAncmVxdWVzdF9ib2R5X2xpbWl0JyB0aGVuCiAgICAgIG1vZGVsLnJlcXVlc3RfYm9keV9saW1pdCA9IHRvbnVtYmVyKHZhbHVlKQoKICAgICAgaWYgbm90IG1vZGVsLnJlcXVlc3RfYm9keV9saW1pdCB0aGVuCiAgICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwucmVxdWVzdF9ib2R5X2xpbWl0JykKICAgICAgZW5kCiAgICBlbHNlaWYgZmllbGQgPT0gJ3Jlc3BvbnNlX2JvZHlfbGltaXQnIHRoZW4KICAgICAgbW9kZWwucmVzcG9uc2VfYm9keV9saW1pdCA9IHRvbnVtYmVyKHZhbHVlKQoKICAgICAgaWYgbm90IG1vZGVsLnJlc3BvbnNlX2JvZHlfbGltaXQgdGhlbgogICAgICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLnJlc3BvbnNlX2JvZHlfbGltaXQnKQogICAgICBlbmQKICAgIGVsc2VpZiBmaWVsZCA9PSAnbWFpbl9wYWdlJyB0aGVuCiAgICAgIG1vZGVsLm1haW5fcGFnZSA9IHZhbHVlCgogICAgICBpZiBub3QgbW9kZWwubWFpbl9wYWdlIHRoZW4KICAgICAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBtb2RlbC5tYWluX3BhZ2UnKQogICAgICBlbmQKICAgIGVsc2VpZiBmaWVsZCA9PSAnbm90X2ZvdW5kX3BhZ2UnIHRoZW4KICAgICAgbW9kZWwubm90X2ZvdW5kX3BhZ2UgPSB2YWx1ZQoKICAgICAgaWYgbm90IG1vZGVsLm5vdF9mb3VuZF9wYWdlIHRoZW4KICAgICAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBtb2RlbC5ub3RfZm91bmRfcGFnZScpCiAgICAgIGVuZAogICAgZWxzZWlmIGZpZWxkID09ICdmYXZpY29uX2ljbycgdGhlbgogICAgICBtb2RlbC5mYXZpY29uX2ljbyA9IHZhbHVlCgogICAgICBpZiBub3QgbW9kZWwuZmF2aWNvbl9pY28gdGhlbgogICAgICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLmZhdmljb25faWNvJykKICAgICAgZW5kCiAgICBlbHNlaWYgZmllbGQgPT0gJ3JvYm90c190eHQnIHRoZW4KICAgICAgbW9kZWwucm9ib3RzX3R4dCA9IHZhbHVlCgogICAgICBpZiBub3QgbW9kZWwucm9ib3RzX3R4dCB0aGVuCiAgICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwucm9ib3RzX3R4dCcpCiAgICAgIGVuZAogICAgZWxzZWlmIGZpZWxkID09ICdzaXRlbWFwX3htbCcgdGhlbgogICAgICBtb2RlbC5zaXRlbWFwX3htbCA9IHZhbHVlCgogICAgICBpZiBub3QgbW9kZWwuc2l0ZW1hcF94bWwgdGhlbgogICAgICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLnNpdGVtYXBfeG1sJykKICAgICAgZW5kCiAgICBlbHNlaWYgZmllbGQgPT0gJ3VwZGF0ZWRfYXQnIHRoZW4KICAgICAgbW9kZWwudXBkYXRlZF9hdCA9IHRvbnVtYmVyKHZhbHVlKQoKICAgICAgaWYgbm90IG1vZGVsLnVwZGF0ZWRfYXQgdGhlbgogICAgICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLnVwZGF0ZWRfYXQnKQogICAgICBlbmQKICAgIGVsc2UKICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgVW5rbm93biBtb2RlbC4nIC4uIGZpZWxkKQogICAgZW5kCiAgZW5kCgogIGlmIG5leHQobW9kZWwpID09IG5pbCB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBOb3RoaW5nIHRvIHVwZGF0ZScpCiAgZW5kCgogIC0tIFBvaW50IG9mIG5vIHJldHVybgoKICBsb2NhbCBzdG9yZSA9IHt9CgogIGZvciBmaWVsZCwgdmFsdWUgaW4gcGFpcnMobW9kZWwpIGRvCiAgICB0YWJsZS5pbnNlcnQoc3RvcmUsIGZpZWxkKQogICAgdGFibGUuaW5zZXJ0KHN0b3JlLCB2YWx1ZSkKICBlbmQKCiAgcmVkaXMuY2FsbCgnSFNFVCcsIHRhcmdldF9rZXksIHVucGFjayhzdG9yZSkpCgogIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ09LIFRhcmdldCB1cGRhdGVkJykKZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICd1cGRhdGVfdGFyZ2V0JywKICBjYWxsYmFjayA9IHVwZGF0ZV90YXJnZXQsCiAgZGVzY3JpcHRpb24gPSAnVXBkYXRlIHRhcmdldCcsCn0pCgotLVtbCiAgRW5hYmxlIHRhcmdldAotLV1dCmxvY2FsIGZ1bmN0aW9uIGVuYWJsZV90YXJnZXQoa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDIgYW5kICNhcmdzID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCB0YXJnZXRfa2V5ID0ga2V5c1syXQoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGNhbXBhaWduX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIGNhbXBhaWduIG5vdCBmb3VuZCcpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgdGFyZ2V0X2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIHRhcmdldCBub3QgZm91bmQnKQogIGVuZAoKICBsb2NhbCBzdGFzaCA9IHsKICAgIHVwZGF0ZWRfYXQgPSB0b251bWJlcihhcmdzWzFdKSwKICAgIGlzX2VuYWJsZWQgPSB0b251bWJlcihyZWRpcy5jYWxsKCdIR0VUJywgdGFyZ2V0X2tleSwgJ2lzX2VuYWJsZWQnKSksCiAgfQoKICBpZiBub3Qgc3Rhc2gudXBkYXRlZF9hdCB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBzdGFzaC51cGRhdGVkX2F0JykKICBlbmQKCiAgaWYgbm90IHN0YXNoLmlzX2VuYWJsZWQgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBzdGFzaC5pc19lbmFibGVkJykKICBlbmQKCiAgaWYgc3Rhc2guaXNfZW5hYmxlZCB+PSAwIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ09LIFRhcmdldCBhbGxyZWFkeSBlbmFibGVkJykKICBlbmQKCiAgLS0gUG9pbnQgb2Ygbm8gcmV0dXJuCgogIC0tIHN0eWx1YTogaWdub3JlCiAgcmVkaXMuY2FsbCgKICAgICdIU0VUJywgdGFyZ2V0X2tleSwKICAgICdpc19lbmFibGVkJywgMSwKICAgICd1cGRhdGVkX2F0Jywgc3Rhc2gudXBkYXRlZF9hdAogICkKCiAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnT0sgVGFyZ2V0IGVuYWJsZWQnKQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ2VuYWJsZV90YXJnZXQnLAogIGNhbGxiYWNrID0gZW5hYmxlX3RhcmdldCwKICBkZXNjcmlwdGlvbiA9ICdFbmFibGUgdGFyZ2V0JywKfSkKCi0tW1sKICBEaXNhYmxlIHRhcmdldAotLV1dCmxvY2FsIGZ1bmN0aW9uIGRpc2FibGVfdGFyZ2V0KGtleXMsIGFyZ3MpCiAgaWYgbm90ICgja2V5cyA9PSAyIGFuZCAjYXJncyA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBmdW5jdGlvbiB1c2UnKQogIGVuZAoKICBsb2NhbCBjYW1wYWlnbl9rZXkgPSBrZXlzWzFdCiAgbG9jYWwgdGFyZ2V0X2tleSA9IGtleXNbMl0KCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBjYW1wYWlnbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBjYW1wYWlnbiBub3QgZm91bmQnKQogIGVuZAoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIHRhcmdldF9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCB0YXJnZXQgbm90IGZvdW5kJykKICBlbmQKCiAgbG9jYWwgc3Rhc2ggPSB7CiAgICB1cGRhdGVkX2F0ID0gdG9udW1iZXIoYXJnc1sxXSksCiAgICBpc19lbmFibGVkID0gdG9udW1iZXIocmVkaXMuY2FsbCgnSEdFVCcsIHRhcmdldF9rZXksICdpc19lbmFibGVkJykpLAogIH0KCiAgaWYgbm90IHN0YXNoLnVwZGF0ZWRfYXQgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3Jvbmcgc3Rhc2gudXBkYXRlZF9hdCcpCiAgZW5kCgogIGlmIG5vdCBzdGFzaC5pc19lbmFibGVkIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gc3Rhc2guaXNfZW5hYmxlZCcpCiAgZW5kCgogIGlmIHN0YXNoLmlzX2VuYWJsZWQgPT0gMCB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBUYXJnZXQgYWxscmVhZHkgZGlzYWJsZWQnKQogIGVuZAoKICAtLSBQb2ludCBvZiBubyByZXR1cm4KCiAgLS0gc3R5bHVhOiBpZ25vcmUKICByZWRpcy5jYWxsKAogICAgJ0hTRVQnLCB0YXJnZXRfa2V5LAogICAgJ2lzX2VuYWJsZWQnLCAwLAogICAgJ3VwZGF0ZWRfYXQnLCBzdGFzaC51cGRhdGVkX2F0CiAgKQoKICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBUYXJnZXQgZGlhYmxlZCcpCmVuZAoKcmVkaXMucmVnaXN0ZXJfZnVuY3Rpb24oewogIGZ1bmN0aW9uX25hbWUgPSAnZGlzYWJsZV90YXJnZXQnLAogIGNhbGxiYWNrID0gZGlzYWJsZV90YXJnZXQsCiAgZGVzY3JpcHRpb24gPSAnRGlzYWJsZSB0YXJnZXQnLAp9KQoKLS1bWwogIEFwcGVuZCB0YXJnZXQgbGFiZWwKLS1dXQpsb2NhbCBmdW5jdGlvbiBhcHBlbmRfdGFyZ2V0X2xhYmVsKGtleXMsIGFyZ3MpCiAgaWYgbm90ICgja2V5cyA9PSAzIGFuZCAjYXJncyA9PSAyKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBmdW5jdGlvbiB1c2UnKQogIGVuZAoKICBsb2NhbCBjYW1wYWlnbl9rZXkgPSBrZXlzWzFdCiAgbG9jYWwgdGFyZ2V0X2tleSA9IGtleXNbMl0KICBsb2NhbCB0YXJnZXRfbGFiZWxzX2tleSA9IGtleXNbM10KCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBjYW1wYWlnbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBDYW1wYWlnbiBub3QgZm91bmQnKQogIGVuZAoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIHRhcmdldF9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBUYXJnZXQgbm90IGZvdW5kJykKICBlbmQKCiAgbG9jYWwgc3Rhc2ggPSB7CiAgICBsYWJlbCA9IGFyZ3NbMV0sCiAgICB1cGRhdGVkX2F0ID0gdG9udW1iZXIoYXJnc1syXSksCiAgfQoKICBpZiBub3QgKHN0YXNoLmxhYmVsIGFuZCAjc3Rhc2gubGFiZWwgPiAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBzdGFzaC5sYWJlbCcpCiAgZW5kCgogIGlmIG5vdCBzdGFzaC51cGRhdGVkX2F0IHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIHN0YXNoLnVwZGF0ZWRfYXQnKQogIGVuZAoKICBpZiByZWRpcy5jYWxsKCdTSVNNRU1CRVInLCB0YXJnZXRfbGFiZWxzX2tleSwgc3Rhc2gubGFiZWwpIH49IDAgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnT0sgVGFyZ2V0IGxhYmVsIGFsbHJlYWR5IGFwcGVuZGVkJykKICBlbmQKCiAgcmVkaXMuY2FsbCgnSFNFVCcsIHRhcmdldF9rZXksICd1cGRhdGVkX2F0Jywgc3Rhc2gudXBkYXRlZF9hdCkKCiAgcmVkaXMuY2FsbCgnU0FERCcsIHRhcmdldF9sYWJlbHNfa2V5LCBzdGFzaC5sYWJlbCkKCiAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnT0sgVGFyZ2V0IGxhYmVsIGFwcGVuZGVkJykKZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICdhcHBlbmRfdGFyZ2V0X2xhYmVsJywKICBjYWxsYmFjayA9IGFwcGVuZF90YXJnZXRfbGFiZWwsCiAgZGVzY3JpcHRpb24gPSAnQXBwZW5kIHRhcmdldCBsYWJlbCcsCn0pCgotLVtbCiAgUmVtb3ZlIHRhcmdldCBsYWJlbAotLV1dCmxvY2FsIGZ1bmN0aW9uIHJlbW92ZV90YXJnZXRfbGFiZWwoa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDMgYW5kICNhcmdzID09IDIpIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCB0YXJnZXRfa2V5ID0ga2V5c1syXQogIGxvY2FsIHRhcmdldF9sYWJlbHNfa2V5ID0ga2V5c1szXQoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGNhbXBhaWduX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIENhbXBhaWduIG5vdCBmb3VuZCcpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgdGFyZ2V0X2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIFRhcmdldCBub3QgZm91bmQnKQogIGVuZAoKICBsb2NhbCBzdGFzaCA9IHsKICAgIGxhYmVsID0gYXJnc1sxXSwKICAgIHVwZGF0ZWRfYXQgPSB0b251bWJlcihhcmdzWzJdKSwKICB9CgogIGlmIG5vdCAoc3Rhc2gubGFiZWwgYW5kICNzdGFzaC5sYWJlbCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIHN0YXNoLmxhYmVsJykKICBlbmQKCiAgaWYgbm90IHN0YXNoLnVwZGF0ZWRfYXQgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3Jvbmcgc3Rhc2gudXBkYXRlZF9hdCcpCiAgZW5kCgogIGlmIHJlZGlzLmNhbGwoJ1NJU01FTUJFUicsIHRhcmdldF9sYWJlbHNfa2V5LCBzdGFzaC5sYWJlbCkgPT0gMCB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBUYXJnZXQgbGFiZWwgbm90IGV4aXN0cycpCiAgZW5kCgogIHJlZGlzLmNhbGwoJ0hTRVQnLCB0YXJnZXRfa2V5LCAndXBkYXRlZF9hdCcsIHN0YXNoLnVwZGF0ZWRfYXQpCgogIHJlZGlzLmNhbGwoJ1NSRU0nLCB0YXJnZXRfbGFiZWxzX2tleSwgc3Rhc2gubGFiZWwpCgogIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ09LIFRhcmdldCBsYWJlbCByZW1vdmVkJykKZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICdyZW1vdmVfdGFyZ2V0X2xhYmVsJywKICBjYWxsYmFjayA9IHJlbW92ZV90YXJnZXRfbGFiZWwsCiAgZGVzY3JpcHRpb24gPSAnUmVtb3ZlIHRhcmdldCBsYWJlbCcsCn0pCgotLVtbCiAgRGVsZXRlIHRhcmdldAotLV1dCmxvY2FsIGZ1bmN0aW9uIGRlbGV0ZV90YXJnZXQoa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDYgYW5kICNhcmdzID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCB0YXJnZXRfa2V5ID0ga2V5c1syXQogIGxvY2FsIHRhcmdldF9sYWJlbHNfa2V5ID0ga2V5c1szXQogIGxvY2FsIHRhcmdldF91bmlxdWVfZG9ub3Jfa2V5ID0ga2V5c1s0XQogIGxvY2FsIHRhcmdldF91bmlxdWVfbWlycm9yX2tleSA9IGtleXNbNV0KICBsb2NhbCB0YXJnZXRfaW5kZXhfa2V5ID0ga2V5c1s2XQoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGNhbXBhaWduX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIENhbXBhaWduIG5vdCBmb3VuZCcpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgdGFyZ2V0X2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIFRhcmdldCBub3QgZm91bmQnKQogIGVuZAoKICBsb2NhbCBzdGFzaCA9IHsKICAgIGNhbXBhaWduX2lkID0gcmVkaXMuY2FsbCgnSEdFVCcsIGNhbXBhaWduX2tleSwgJ2NhbXBhaWduX2lkJyksCiAgICB0YXJnZXRfaWQgPSByZWRpcy5jYWxsKCdIR0VUJywgdGFyZ2V0X2tleSwgJ3RhcmdldF9pZCcpLAogICAgZG9ub3Jfc3ViID0gcmVkaXMuY2FsbCgnSEdFVCcsIHRhcmdldF9rZXksICdkb25vcl9zdWInKSwKICAgIGRvbm9yX2RvbWFpbiA9IHJlZGlzLmNhbGwoJ0hHRVQnLCB0YXJnZXRfa2V5LCAnZG9ub3JfZG9tYWluJyksCiAgICBkb25vcl9wb3J0ID0gdG9udW1iZXIocmVkaXMuY2FsbCgnSEdFVCcsIHRhcmdldF9rZXksICdkb25vcl9wb3J0JykpLAogICAgbWlycm9yX3N1YiA9IHJlZGlzLmNhbGwoJ0hHRVQnLCB0YXJnZXRfa2V5LCAnbWlycm9yX3N1YicpLAogICAgbWlycm9yX3BvcnQgPSB0b251bWJlcihyZWRpcy5jYWxsKCdIR0VUJywgdGFyZ2V0X2tleSwgJ21pcnJvcl9wb3J0JykpLAogICAgaXNfZW5hYmxlZCA9IHRvbnVtYmVyKHJlZGlzLmNhbGwoJ0hHRVQnLCB0YXJnZXRfa2V5LCAnaXNfZW5hYmxlZCcpKSwKICB9CgogIGlmIG5vdCAoc3Rhc2guY2FtcGFpZ25faWQgYW5kICNzdGFzaC5jYW1wYWlnbl9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gc3Rhc2guY2FtcGFpZ25faWQnKQogIGVuZAoKICBpZiBub3QgKHN0YXNoLnRhcmdldF9pZCBhbmQgI3N0YXNoLnRhcmdldF9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gc3Rhc2gudGFyZ2V0X2lkJykKICBlbmQKCiAgaWYgbm90IChzdGFzaC5kb25vcl9zdWIgYW5kICNzdGFzaC5kb25vcl9zdWIgPiAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIHN0YXNoLmRhZG9ub3Jfc3ViJykKICBlbmQKCiAgaWYgbm90IChzdGFzaC5kb25vcl9kb21haW4gYW5kICNzdGFzaC5kb25vcl9kb21haW4gPiAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIHN0YXNoLmRvbm9yX2RvbWFpbicpCiAgZW5kCgogIGlmIG5vdCAoc3Rhc2guZG9ub3JfcG9ydCBhbmQgc3Rhc2guZG9ub3JfcG9ydCA+PSAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIHN0YXNoLmRvbm9yX3BvcnQnKQogIGVuZAoKICBpZiBub3QgKHN0YXNoLm1pcnJvcl9zdWIgYW5kICNzdGFzaC5taXJyb3Jfc3ViID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBzdGFzaC5taXJyb3Jfc3ViJykKICBlbmQKCiAgaWYgbm90IChzdGFzaC5taXJyb3JfcG9ydCBhbmQgc3Rhc2gubWlycm9yX3BvcnQgPj0gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBzdGFzaC5taXJyb3JfcG9ydCcpCiAgZW5kCgogIGlmIG5vdCBzdGFzaC5pc19lbmFibGVkIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gc3Rhc2guaXNfZW5hYmxlZCcpCiAgZW5kCgogIGlmIHN0YXNoLmlzX2VuYWJsZWQgfj0gMCB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdGT1JCSURERU4gVGFyZ2V0IG5vdCBkaXNhYmxlZCcpCiAgZW5kCgogIC0tIHN0eWx1YTogaWdub3JlCiAgbG9jYWwgZG9ub3IgPSBzdGFzaC5jYW1wYWlnbl9pZAogICAgLi4gJ1x0JyAuLiBzdGFzaC5kb25vcl9zdWIKICAgIC4uICdcdCcgLi4gc3Rhc2guZG9ub3JfZG9tYWluCiAgICAuLiAnXHQnIC4uIHRvc3RyaW5nKHN0YXNoLmRvbm9yX3BvcnQpCgogIC0tIHN0eWx1YTogaWdub3JlCiAgbG9jYWwgbWlycm9yID0gc3Rhc2guY2FtcGFpZ25faWQKICAgIC4uICdcdCcgLi4gc3Rhc2gubWlycm9yX3N1YgogICAgLi4gJ1x0JyAuLiB0b3N0cmluZyhzdGFzaC5taXJyb3JfcG9ydCkKCiAgLS0gUG9pbnQgb2Ygbm8gcmV0dXJuCgogIHJlZGlzLmNhbGwoJ0RFTCcsIHRhcmdldF9rZXkpCiAgcmVkaXMuY2FsbCgnREVMJywgdGFyZ2V0X2xhYmVsc19rZXkpCgogIHJlZGlzLmNhbGwoJ1NSRU0nLCB0YXJnZXRfdW5pcXVlX2Rvbm9yX2tleSwgZG9ub3IpCiAgcmVkaXMuY2FsbCgnU1JFTScsIHRhcmdldF91bmlxdWVfbWlycm9yX2tleSwgbWlycm9yKQoKICByZWRpcy5jYWxsKCdaUkVNJywgdGFyZ2V0X2luZGV4X2tleSwgc3Rhc2gudGFyZ2V0X2lkKQoKICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBUYXJnZXQgZGVsZXRlZCcpCmVuZAoKcmVkaXMucmVnaXN0ZXJfZnVuY3Rpb24oewogIGZ1bmN0aW9uX25hbWUgPSAnZGVsZXRlX3RhcmdldCcsCiAgY2FsbGJhY2sgPSBkZWxldGVfdGFyZ2V0LAogIGRlc2NyaXB0aW9uID0gJ0RlbGV0ZSB0YXJnZXQnLAp9KQo=`,

  // 4-redirector.lua
  `IyFsdWEgbmFtZT1yZWRpcmVjdG9yCgotLVtbCiAgQ3JlYXRlIHJlZGlyZWN0b3IKLS1dXQpsb2NhbCBmdW5jdGlvbiBjcmVhdGVfcmVkaXJlY3RvcihrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gMyBhbmQgI2FyZ3MgPT0gNCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgZnVuY3Rpb24gdXNlJykKICBlbmQKCiAgbG9jYWwgY2FtcGFpZ25fa2V5ID0ga2V5c1sxXQogIGxvY2FsIHJlZGlyZWN0b3Jfa2V5ID0ga2V5c1syXQogIGxvY2FsIHJlZGlyZWN0b3JfaW5kZXhfa2V5ID0ga2V5c1szXQoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGNhbXBhaWduX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIENhbXBhaWduIG5vdCBmb3VuZCcpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgcmVkaXJlY3Rvcl9rZXkpID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ0NPTkZMSUNUIFJlZGlyZWN0b3IgYWxscmVhZHkgZXhpc3RzJykKICBlbmQKCiAgbG9jYWwgbW9kZWwgPSB7CiAgICBjYW1wYWlnbl9pZCA9IGFyZ3NbMV0sCiAgICByZWRpcmVjdG9yX2lkID0gYXJnc1syXSwKICAgIHBhZ2UgPSBhcmdzWzNdLAogICAgbHVyZV9jb3VudCA9IDAsCiAgICBjcmVhdGVkX2F0ID0gdG9udW1iZXIoYXJnc1s0XSksCiAgICB1cGRhdGVkX2F0ID0gdG9udW1iZXIoYXJnc1s0XSksCiAgfQoKICBmb3IgZmllbGQsIHZhbHVlIGluIHBhaXJzKG1vZGVsKSBkbwogICAgaWYgbm90IHZhbHVlIHRoZW4KICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwuJyAuLiBmaWVsZCkKICAgIGVuZAogIGVuZAoKICBpZiBub3QgKCNtb2RlbC5jYW1wYWlnbl9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLmNhbXBhaWduX2lkJykKICBlbmQKCiAgaWYgbm90ICgjbW9kZWwucmVkaXJlY3Rvcl9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLnJlZGlyZWN0b3JfaWQnKQogIGVuZAoKICAtLSBQb2ludCBvZiBubyByZXR1cm4KCiAgbG9jYWwgc3RvcmUgPSB7fQoKICBmb3IgZmllbGQsIHZhbHVlIGluIHBhaXJzKG1vZGVsKSBkbwogICAgdGFibGUuaW5zZXJ0KHN0b3JlLCBmaWVsZCkKICAgIHRhYmxlLmluc2VydChzdG9yZSwgdmFsdWUpCiAgZW5kCgogIHJlZGlzLmNhbGwoJ0hTRVQnLCByZWRpcmVjdG9yX2tleSwgdW5wYWNrKHN0b3JlKSkKCiAgcmVkaXMuY2FsbCgnWkFERCcsIHJlZGlyZWN0b3JfaW5kZXhfa2V5LCBtb2RlbC5jcmVhdGVkX2F0LCBtb2RlbC5yZWRpcmVjdG9yX2lkKQoKICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBSZWRpcmVjdG9yIGNyZWF0ZWQnKQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ2NyZWF0ZV9yZWRpcmVjdG9yJywKICBjYWxsYmFjayA9IGNyZWF0ZV9yZWRpcmVjdG9yLAogIGRlc2NyaXB0aW9uID0gJ0NyZWF0ZSByZWRpcmVjdG9yJywKfSkKCi0tW1sKICBSZWFkIHJlZGlyZWN0b3IKLS1dXQpsb2NhbCBmdW5jdGlvbiByZWFkX3JlZGlyZWN0b3Ioa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDIgYW5kICNhcmdzID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCByZWRpcmVjdG9yX2tleSA9IGtleXNbMl0KCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBjYW1wYWlnbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiBuaWwKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCByZWRpcmVjdG9yX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIG5pbAogIGVuZAoKICAtLSBzdHlsdWE6IGlnbm9yZQogIGxvY2FsIHZhbHVlcyA9IHJlZGlzLmNhbGwoCiAgICAnSE1HRVQnLCByZWRpcmVjdG9yX2tleSwKICAgICdjYW1wYWlnbl9pZCcsCiAgICAncmVkaXJlY3Rvcl9pZCcsCiAgICAnbHVyZV9jb3VudCcsCiAgICAnY3JlYXRlZF9hdCcsCiAgICAndXBkYXRlZF9hdCcKICApCgogIGlmIG5vdCAoI3ZhbHVlcyA9PSA1KSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIHZhbHVlcycpCiAgZW5kCgogIGxvY2FsIG1vZGVsID0gewogICAgY2FtcGFpZ25faWQgPSB2YWx1ZXNbMV0sCiAgICByZWRpcmVjdG9yX2lkID0gdmFsdWVzWzJdLAogICAgbHVyZV9jb3VudCA9IHRvbnVtYmVyKHZhbHVlc1szXSksCiAgICBjcmVhdGVkX2F0ID0gdG9udW1iZXIodmFsdWVzWzRdKSwKICAgIHVwZGF0ZWRfYXQgPSB0b251bWJlcih2YWx1ZXNbNV0pLAogIH0KCiAgZm9yIGZpZWxkLCB2YWx1ZSBpbiBwYWlycyhtb2RlbCkgZG8KICAgIGlmIG5vdCB2YWx1ZSB0aGVuCiAgICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gbW9kZWwuJyAuLiBmaWVsZCkKICAgIGVuZAogIGVuZAoKICByZXR1cm4geyBtYXAgPSBtb2RlbCB9CmVuZAoKcmVkaXMucmVnaXN0ZXJfZnVuY3Rpb24oewogIGZ1bmN0aW9uX25hbWUgPSAncmVhZF9yZWRpcmVjdG9yJywKICBjYWxsYmFjayA9IHJlYWRfcmVkaXJlY3RvciwKICBmbGFncyA9IHsgJ25vLXdyaXRlcycgfSwKICBkZXNjcmlwdGlvbiA9ICdSZWFkIHJlZGlyZWN0b3InLAp9KQoKLS1bWwogIFJlYWQgZnVsbCByZWRpcmVjdG9yCi0tXV0KbG9jYWwgZnVuY3Rpb24gcmVhZF9mdWxsX3JlZGlyZWN0b3Ioa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDIgYW5kICNhcmdzID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCByZWRpcmVjdG9yX2tleSA9IGtleXNbMl0KCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBjYW1wYWlnbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiBuaWwKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCByZWRpcmVjdG9yX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIG5pbAogIGVuZAoKICAtLSBzdHlsdWE6IGlnbm9yZQogIGxvY2FsIHZhbHVlcyA9IHJlZGlzLmNhbGwoCiAgICAnSE1HRVQnLCByZWRpcmVjdG9yX2tleSwKICAgICdjYW1wYWlnbl9pZCcsCiAgICAncmVkaXJlY3Rvcl9pZCcsCiAgICAncGFnZScsCiAgICAnbHVyZV9jb3VudCcsCiAgICAnY3JlYXRlZF9hdCcsCiAgICAndXBkYXRlZF9hdCcKICApCgogIGlmIG5vdCAoI3ZhbHVlcyA9PSA2KSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIHZhbHVlcycpCiAgZW5kCgogIGxvY2FsIG1vZGVsID0gewogICAgY2FtcGFpZ25faWQgPSB2YWx1ZXNbMV0sCiAgICByZWRpcmVjdG9yX2lkID0gdmFsdWVzWzJdLAogICAgcGFnZSA9IHZhbHVlc1szXSwKICAgIGx1cmVfY291bnQgPSB0b251bWJlcih2YWx1ZXNbNF0pLAogICAgY3JlYXRlZF9hdCA9IHRvbnVtYmVyKHZhbHVlc1s1XSksCiAgICB1cGRhdGVkX2F0ID0gdG9udW1iZXIodmFsdWVzWzZdKSwKICB9CgogIGZvciBmaWVsZCwgdmFsdWUgaW4gcGFpcnMobW9kZWwpIGRvCiAgICBpZiBub3QgdmFsdWUgdGhlbgogICAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIG1vZGVsLicgLi4gZmllbGQpCiAgICBlbmQKICBlbmQKCiAgcmV0dXJuIHsgbWFwID0gbW9kZWwgfQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ3JlYWRfZnVsbF9yZWRpcmVjdG9yJywKICBjYWxsYmFjayA9IHJlYWRfZnVsbF9yZWRpcmVjdG9yLAogIGZsYWdzID0geyAnbm8td3JpdGVzJyB9LAogIGRlc2NyaXB0aW9uID0gJ1JlYWQgZnVsbCByZWRpcmVjdG9yJywKfSkKCi0tW1sKICBSZWFkIHJlZGlyZWN0b3IgaW5kZXgKLS1dXQpsb2NhbCBmdW5jdGlvbiByZWFkX3JlZGlyZWN0b3JfaW5kZXgoa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDIgYW5kICNhcmdzID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCByZWRpcmVjdG9yX2luZGV4X2tleSA9IGtleXNbMl0KCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBjYW1wYWlnbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiBuaWwKICBlbmQKCiAgcmV0dXJuIHJlZGlzLmNhbGwoJ1pSQU5HRScsIHJlZGlyZWN0b3JfaW5kZXhfa2V5LCAwLCAtMSkKZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICdyZWFkX3JlZGlyZWN0b3JfaW5kZXgnLAogIGNhbGxiYWNrID0gcmVhZF9yZWRpcmVjdG9yX2luZGV4LAogIGZsYWdzID0geyAnbm8td3JpdGVzJyB9LAogIGRlc2NyaXB0aW9uID0gJ1JlYWQgcmVkaXJlY3RvciBpbmRleCcsCn0pCgotLVtbCiAgVXBkYXRlIHJlZGlyZWN0b3IKLS1dXQpsb2NhbCBmdW5jdGlvbiB1cGRhdGVfcmVkaXJlY3RvcihrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gMiBhbmQgI2FyZ3MgPj0gMCBhbmQgI2FyZ3MgJSAyID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCByZWRpcmVjdG9yX2tleSA9IGtleXNbMl0KCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBjYW1wYWlnbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBDYW1wYWlnbiBub3QgZm91bmQnKQogIGVuZAoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIHJlZGlyZWN0b3Jfa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdOT1RfRk9VTkQgUmVkaXJlY3RvciBub3QgZm91bmQnKQogIGVuZAoKICBsb2NhbCBtb2RlbCA9IHt9CgogIGZvciBpID0gMSwgI2FyZ3MsIDIgZG8KICAgIGxvY2FsIGZpZWxkLCB2YWx1ZSA9IGFyZ3NbaV0sIGFyZ3NbaSArIDFdCgogICAgaWYgbW9kZWxbZmllbGRdIHRoZW4KICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgRHVwbGljYXRlIG1vZGVsLicgLi4gZmllbGQpCiAgICBlbmQKCiAgICBpZiBmaWVsZCA9PSAncGFnZScgdGhlbgogICAgICBtb2RlbC5wYWdlID0gdmFsdWUKCiAgICAgIGlmIG5vdCBtb2RlbC5wYWdlIHRoZW4KICAgICAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBtb2RlbC5wYWdlJykKICAgICAgZW5kCiAgICBlbHNlaWYgZmllbGQgPT0gJ3VwZGF0ZWRfYXQnIHRoZW4KICAgICAgbW9kZWwudXBkYXRlZF9hdCA9IHRvbnVtYmVyKHZhbHVlKQoKICAgICAgaWYgbm90IG1vZGVsLnVwZGF0ZWRfYXQgdGhlbgogICAgICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLnVwZGF0ZWRfYXQnKQogICAgICBlbmQKICAgIGVsc2UKICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgVW5rbm93biBtb2RlbC4nIC4uIGZpZWxkKQogICAgZW5kCiAgZW5kCgogIGlmIG5leHQobW9kZWwpID09IG5pbCB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBOb3RoaW5nIHRvIHVwZGF0ZScpCiAgZW5kCgogIC0tIFBvaW50IG9mIG5vIHJldHVybgoKICBsb2NhbCBzdG9yZSA9IHt9CgogIGZvciBmaWVsZCwgdmFsdWUgaW4gcGFpcnMobW9kZWwpIGRvCiAgICB0YWJsZS5pbnNlcnQoc3RvcmUsIGZpZWxkKQogICAgdGFibGUuaW5zZXJ0KHN0b3JlLCB2YWx1ZSkKICBlbmQKCiAgcmVkaXMuY2FsbCgnSFNFVCcsIHJlZGlyZWN0b3Jfa2V5LCB1bnBhY2soc3RvcmUpKQoKICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBSZWRpcmVjdG9yIHVwZGF0ZWQnKQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ3VwZGF0ZV9yZWRpcmVjdG9yJywKICBjYWxsYmFjayA9IHVwZGF0ZV9yZWRpcmVjdG9yLAogIGRlc2NyaXB0aW9uID0gJ1VwZGF0ZSByZWRpcmVjdG9yJywKfSkKCi0tW1sKICBEZWxldGUgcmVkaXJlY3RvcgotLV1dCmxvY2FsIGZ1bmN0aW9uIGRlbGV0ZV9yZWRpcmVjdG9yKGtleXMsIGFyZ3MpCiAgaWYgbm90ICgja2V5cyA9PSAzIGFuZCAjYXJncyA9PSAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBmdW5jdGlvbiB1c2UnKQogIGVuZAoKICBsb2NhbCBjYW1wYWlnbl9rZXkgPSBrZXlzWzFdCiAgbG9jYWwgcmVkaXJlY3Rvcl9rZXkgPSBrZXlzWzJdCiAgbG9jYWwgcmVkaXJlY3Rvcl9pbmRleF9rZXkgPSBrZXlzWzNdCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgY2FtcGFpZ25fa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdOT1RfRk9VTkQgY2FtcGFpZ24gbm90IGZvdW5kJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCByZWRpcmVjdG9yX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIHJlZGlyZWN0b3Igbm90IGZvdW5kJykKICBlbmQKCiAgbG9jYWwgc3Rhc2ggPSB7CiAgICByZWRpcmVjdG9yX2lkID0gcmVkaXMuY2FsbCgnSEdFVCcsIHJlZGlyZWN0b3Jfa2V5LCAncmVkaXJlY3Rvcl9pZCcpLAogICAgbHVyZV9jb3VudCA9IHRvbnVtYmVyKHJlZGlzLmNhbGwoJ0hHRVQnLCByZWRpcmVjdG9yX2tleSwgJ2x1cmVfY291bnQnKSksCiAgfQoKICBpZiBub3QgKHN0YXNoLnJlZGlyZWN0b3JfaWQgYW5kICNzdGFzaC5yZWRpcmVjdG9yX2lkID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBzdGFzaC5yZWRpcmVjdG9yX2lkJykKICBlbmQKCiAgaWYgbm90IChzdGFzaC5sdXJlX2NvdW50IGFuZCBzdGFzaC5sdXJlX2NvdW50ID49IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gc3Rhc2gubHVyZV9jb3VudCcpCiAgZW5kCgogIGlmIHN0YXNoLmx1cmVfY291bnQgPiAwIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ0ZPUkJJRERFTiBMdXJlcyBleGlzdHMnKQogIGVuZAoKICAtLSBQb2ludCBvZiBubyByZXR1cm4KCiAgcmVkaXMuY2FsbCgnREVMJywgcmVkaXJlY3Rvcl9rZXkpCgogIHJlZGlzLmNhbGwoJ1pSRU0nLCByZWRpcmVjdG9yX2luZGV4X2tleSwgc3Rhc2gucmVkaXJlY3Rvcl9pZCkKCiAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnT0sgUmVkaXJlY3RvciBkZWxldGVkJykKZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICdkZWxldGVfcmVkaXJlY3RvcicsCiAgY2FsbGJhY2sgPSBkZWxldGVfcmVkaXJlY3RvciwKICBkZXNjcmlwdGlvbiA9ICdEZWxldGUgdGFyZ2V0JywKfSkK`,

  // 5-lure.lua
  `IyFsdWEgbmFtZT1sdXJlCgotLVtbCiAgQ3JlYXRlIGx1cmUKLS1dXQpsb2NhbCBmdW5jdGlvbiBjcmVhdGVfbHVyZShrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gNSBhbmQgI2FyZ3MgPT0gNSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgZnVuY3Rpb24gdXNlJykKICBlbmQKCiAgbG9jYWwgY2FtcGFpZ25fa2V5ID0ga2V5c1sxXQogIGxvY2FsIGx1cmVfa2V5ID0ga2V5c1syXQogIGxvY2FsIGx1cmVfcGF0aF9rZXkgPSBrZXlzWzNdCiAgbG9jYWwgbHVyZV9pbmRleF9rZXkgPSBrZXlzWzRdCiAgbG9jYWwgcmVkaXJlY3Rvcl9rZXkgPSBrZXlzWzVdCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgY2FtcGFpZ25fa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdOT1RfRk9VTkQgQ2FtcGFpZ24gbm90IGZvdW5kJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBsdXJlX2tleSkgPT0gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnQ09ORkxJQ1QgTHVyZSBhbGxyZWFkeSBleGlzdHMnKQogIGVuZAoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGx1cmVfcGF0aF9rZXkpID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ0NPTkZMSUNUIEx1cmUgcGF0aCBhbGxyZWFkeSB0YWtlbicpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgcmVkaXJlY3Rvcl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBSZWRpcmVjdG9yIG5vdCBmb3VuZCcpCiAgZW5kCgogIGxvY2FsIG1vZGVsID0gewogICAgY2FtcGFpZ25faWQgPSBhcmdzWzFdLAogICAgbHVyZV9pZCA9IGFyZ3NbMl0sCiAgICBwYXRoID0gYXJnc1szXSwKICAgIHJlZGlyZWN0b3JfaWQgPSBhcmdzWzRdLAogICAgaXNfZW5hYmxlZCA9IDAsCiAgICBzZXNzaW9uX2NvdW50ID0gMCwKICAgIGNyZWF0ZWRfYXQgPSB0b251bWJlcihhcmdzWzVdKSwKICAgIHVwZGF0ZWRfYXQgPSB0b251bWJlcihhcmdzWzVdKSwKICB9CgogIGZvciBmaWVsZCwgdmFsdWUgaW4gcGFpcnMobW9kZWwpIGRvCiAgICBpZiBub3QgdmFsdWUgdGhlbgogICAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBtb2RlbC4nIC4uIGZpZWxkKQogICAgZW5kCiAgZW5kCgogIGlmIG5vdCAoI21vZGVsLmNhbXBhaWduX2lkID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwuY2FtcGFpZ25faWQnKQogIGVuZAoKICBpZiBub3QgKCNtb2RlbC5sdXJlX2lkID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwubHVyZV9pZCcpCiAgZW5kCgogIGlmIG5vdCAoI21vZGVsLnBhdGggPiAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBtb2RlbC5wYXRoJykKICBlbmQKCiAgaWYgbm90ICgjbW9kZWwucmVkaXJlY3Rvcl9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLnJlZGlyZWN0b3JfaWQnKQogIGVuZAoKICAtLSBQb2ludCBvZiBubyByZXR1cm4KCiAgbG9jYWwgc3RvcmUgPSB7fQoKICBmb3IgZmllbGQsIHZhbHVlIGluIHBhaXJzKG1vZGVsKSBkbwogICAgdGFibGUuaW5zZXJ0KHN0b3JlLCBmaWVsZCkKICAgIHRhYmxlLmluc2VydChzdG9yZSwgdmFsdWUpCiAgZW5kCgogIHJlZGlzLmNhbGwoJ0hTRVQnLCBsdXJlX2tleSwgdW5wYWNrKHN0b3JlKSkKCiAgcmVkaXMuY2FsbCgnU0VUJywgbHVyZV9wYXRoX2tleSwgbW9kZWwubHVyZV9pZCkKCiAgcmVkaXMuY2FsbCgnWkFERCcsIGx1cmVfaW5kZXhfa2V5LCBtb2RlbC5jcmVhdGVkX2F0LCBtb2RlbC5sdXJlX2lkKQoKICByZWRpcy5jYWxsKCdISU5DUkJZJywgcmVkaXJlY3Rvcl9rZXksICdsdXJlX2NvdW50JywgMSkKCiAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnT0sgTHVyZSBjcmVhdGVkJykKZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICdjcmVhdGVfbHVyZScsCiAgY2FsbGJhY2sgPSBjcmVhdGVfbHVyZSwKICBkZXNjcmlwdGlvbiA9ICdDcmVhdGUgbHVyZScsCn0pCgotLVtbCiAgUmVhZCBsdXJlCi0tXV0KbG9jYWwgZnVuY3Rpb24gcmVhZF9sdXJlKGtleXMsIGFyZ3MpCiAgaWYgbm90ICgja2V5cyA9PSAyIGFuZCAjYXJncyA9PSAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBmdW5jdGlvbiB1c2UnKQogIGVuZAoKICBsb2NhbCBjYW1wYWlnbl9rZXkgPSBrZXlzWzFdCiAgbG9jYWwgbHVyZV9rZXkgPSBrZXlzWzJdCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgY2FtcGFpZ25fa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gbmlsCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgbHVyZV9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiBuaWwKICBlbmQKCiAgLS0gc3R5bHVhOiBpZ25vcmUKICBsb2NhbCB2YWx1ZXMgPSAgcmVkaXMuY2FsbCgKICAgICdITUdFVCcsIGx1cmVfa2V5LAogICAgJ2NhbXBhaWduX2lkJywKICAgICdsdXJlX2lkJywKICAgICdwYXRoJywKICAgICdyZWRpcmVjdG9yX2lkJywKICAgICdpc19lbmFibGVkJywKICAgICdzZXNzaW9uX2NvdW50JywKICAgICdjcmVhdGVkX2F0JywKICAgICd1cGRhdGVkX2F0JwogICkKCiAgaWYgbm90ICgjdmFsdWVzID09IDgpIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gdmFsdWVzJykKICBlbmQKCiAgbG9jYWwgbW9kZWwgPSB7CiAgICBjYW1wYWlnbl9pZCA9IHZhbHVlc1sxXSwKICAgIGx1cmVfaWQgPSB2YWx1ZXNbMl0sCiAgICBwYXRoID0gdmFsdWVzWzNdLAogICAgcmVkaXJlY3Rvcl9pZCA9IHZhbHVlc1s0XSwKICAgIGlzX2VuYWJsZWQgPSB0b251bWJlcih2YWx1ZXNbNV0pLAogICAgc2Vzc2lvbl9jb3VudCA9IHRvbnVtYmVyKHZhbHVlc1s2XSksCiAgICBjcmVhdGVkX2F0ID0gdG9udW1iZXIodmFsdWVzWzddKSwKICAgIHVwZGF0ZWRfYXQgPSB0b251bWJlcih2YWx1ZXNbOF0pLAogIH0KCiAgZm9yIGZpZWxkLCB2YWx1ZSBpbiBwYWlycyhtb2RlbCkgZG8KICAgIGlmIG5vdCB2YWx1ZSB0aGVuCiAgICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gbW9kZWwuJyAuLiBmaWVsZCkKICAgIGVuZAogIGVuZAoKICByZXR1cm4geyBtYXAgPSBtb2RlbCB9CmVuZAoKcmVkaXMucmVnaXN0ZXJfZnVuY3Rpb24oewogIGZ1bmN0aW9uX25hbWUgPSAncmVhZF9sdXJlJywKICBjYWxsYmFjayA9IHJlYWRfbHVyZSwKICBmbGFncyA9IHsgJ25vLXdyaXRlcycgfSwKICBkZXNjcmlwdGlvbiA9ICdSZWFkIGx1cmUnLAp9KQoKLS1bWwogIFJlYWQgbHVyZSBwYXRoCi0tXV0KbG9jYWwgZnVuY3Rpb24gcmVhZF9sdXJlX3BhdGgoa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDIgYW5kICNhcmdzID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCBsdXJlX3BhdGhfa2V5ID0ga2V5c1syXQoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGNhbXBhaWduX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIG5pbAogIGVuZAoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGx1cmVfcGF0aF9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiBuaWwKICBlbmQKCiAgcmV0dXJuIHJlZGlzLmNhbGwoJ0dFVCcsIGx1cmVfcGF0aF9rZXkpCmVuZAoKcmVkaXMucmVnaXN0ZXJfZnVuY3Rpb24oewogIGZ1bmN0aW9uX25hbWUgPSAncmVhZF9sdXJlX3BhdGgnLAogIGNhbGxiYWNrID0gcmVhZF9sdXJlX3BhdGgsCiAgZmxhZ3MgPSB7ICduby13cml0ZXMnIH0sCiAgZGVzY3JpcHRpb24gPSAnUmVhZCBsdXJlIHBhdGgnLAp9KQoKLS1bWwogIFJlYWQgbHVyZSBpbmRleAotLV1dCmxvY2FsIGZ1bmN0aW9uIHJlYWRfbHVyZV9pbmRleChrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gMiBhbmQgI2FyZ3MgPT0gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgZnVuY3Rpb24gdXNlJykKICBlbmQKCiAgbG9jYWwgY2FtcGFpZ25fa2V5ID0ga2V5c1sxXQogIGxvY2FsIGx1cmVfaW5kZXhfa2V5ID0ga2V5c1syXQoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGNhbXBhaWduX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIG5pbAogIGVuZAoKICByZXR1cm4gcmVkaXMuY2FsbCgnWlJBTkdFJywgbHVyZV9pbmRleF9rZXksIDAsIC0xKQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ3JlYWRfbHVyZV9pbmRleCcsCiAgY2FsbGJhY2sgPSByZWFkX2x1cmVfaW5kZXgsCiAgZmxhZ3MgPSB7ICduby13cml0ZXMnIH0sCiAgZGVzY3JpcHRpb24gPSAnUmVhZCBsdXJlIGluZGV4JywKfSkKCi0tW1sKICBFbmFibGUgbHVyZQotLV1dCmxvY2FsIGZ1bmN0aW9uIGVuYWJsZV9sdXJlKGtleXMsIGFyZ3MpCiAgaWYgbm90ICgja2V5cyA9PSAyIGFuZCAjYXJncyA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBmdW5jdGlvbiB1c2UnKQogIGVuZAoKICBsb2NhbCBjYW1wYWlnbl9rZXkgPSBrZXlzWzFdCiAgbG9jYWwgbHVyZV9rZXkgPSBrZXlzWzJdCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgY2FtcGFpZ25fa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdOT1RfRk9VTkQgQ2FtcGFpZ24gbm90IGZvdW5kJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBsdXJlX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIEx1cmUgbm90IGZvdW5kJykKICBlbmQKCiAgbG9jYWwgc3Rhc2ggPSB7CiAgICB1cGRhdGVkX2F0ID0gdG9udW1iZXIoYXJnc1sxXSksCiAgICBpc19lbmFibGVkID0gdG9udW1iZXIocmVkaXMuY2FsbCgnSEdFVCcsIGx1cmVfa2V5LCAnaXNfZW5hYmxlZCcpKSwKICB9CgogIGlmIG5vdCBzdGFzaC51cGRhdGVkX2F0IHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIHN0YXNoLnVwZGF0ZWRfYXQnKQogIGVuZAoKICBpZiBub3Qgc3Rhc2guaXNfZW5hYmxlZCB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIHN0YXNoLmlzX2VuYWJsZWQnKQogIGVuZAoKICBpZiBzdGFzaC5pc19lbmFibGVkIH49IDAgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnT0sgTHVyZSBhbGxyZWFkeSBlbmFibGVkJykKICBlbmQKCiAgLS0gUG9pbnQgb2Ygbm8gcmV0dXJuCgogIC0tIHN0eWx1YTogaWdub3JlCiAgcmVkaXMuY2FsbCgKICAgICdIU0VUJywgbHVyZV9rZXksCiAgICAnaXNfZW5hYmxlZCcsIDEsCiAgICAndXBkYXRlZF9hdCcsIHN0YXNoLnVwZGF0ZWRfYXQKICApCgogIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ09LIEx1cmUgZW5hYmxlZCcpCmVuZAoKcmVkaXMucmVnaXN0ZXJfZnVuY3Rpb24oewogIGZ1bmN0aW9uX25hbWUgPSAnZW5hYmxlX2x1cmUnLAogIGNhbGxiYWNrID0gZW5hYmxlX2x1cmUsCiAgZGVzY3JpcHRpb24gPSAnRW5hYmxlIGx1cmUnLAp9KQoKLS1bWwogIERpc2FibGUgbHVyZQotLV1dCmxvY2FsIGZ1bmN0aW9uIGRpc2FibGVfbHVyZShrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gMiBhbmQgI2FyZ3MgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgZnVuY3Rpb24gdXNlJykKICBlbmQKCiAgbG9jYWwgY2FtcGFpZ25fa2V5ID0ga2V5c1sxXQogIGxvY2FsIGx1cmVfa2V5ID0ga2V5c1syXQoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGNhbXBhaWduX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIENhbXBhaWduIG5vdCBmb3VuZCcpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgbHVyZV9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBMdXJlIG5vdCBmb3VuZCcpCiAgZW5kCgogIGxvY2FsIHN0YXNoID0gewogICAgdXBkYXRlZF9hdCA9IHRvbnVtYmVyKGFyZ3NbMV0pLAogICAgaXNfZW5hYmxlZCA9IHRvbnVtYmVyKHJlZGlzLmNhbGwoJ0hHRVQnLCBsdXJlX2tleSwgJ2lzX2VuYWJsZWQnKSksCiAgfQoKICBpZiBub3Qgc3Rhc2gudXBkYXRlZF9hdCB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBzdGFzaC51cGRhdGVkX2F0JykKICBlbmQKCiAgaWYgbm90IHN0YXNoLmlzX2VuYWJsZWQgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBzdGFzaC5pc19lbmFibGVkJykKICBlbmQKCiAgaWYgc3Rhc2guaXNfZW5hYmxlZCA9PSAwIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ09LIEx1cmUgYWxscmVhZHkgZGlzYWJsZWQnKQogIGVuZAoKICAtLSBQb2ludCBvZiBubyByZXR1cm4KCiAgLS0gc3R5bHVhOiBpZ25vcmUKICByZWRpcy5jYWxsKAogICAgJ0hTRVQnLCBsdXJlX2tleSwKICAgICdpc19lbmFibGVkJywgMCwKICAgICd1cGRhdGVkX2F0Jywgc3Rhc2gudXBkYXRlZF9hdAogICkKCiAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnT0sgTHVyZSBkaXNhYmxlZCcpCmVuZAoKcmVkaXMucmVnaXN0ZXJfZnVuY3Rpb24oewogIGZ1bmN0aW9uX25hbWUgPSAnZGlzYWJsZV9sdXJlJywKICBjYWxsYmFjayA9IGRpc2FibGVfbHVyZSwKICBkZXNjcmlwdGlvbiA9ICdEaXNhYmxlIGx1cmUnLAp9KQoKLS1bWwogIERlbGV0ZSBsdXJlCi0tXV0KbG9jYWwgZnVuY3Rpb24gZGVsZXRlX2x1cmUoa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDUgYW5kICNhcmdzID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCBsdXJlX2tleSA9IGtleXNbMl0KICBsb2NhbCBsdXJlX3BhdGhfa2V5ID0ga2V5c1szXQogIGxvY2FsIGx1cmVfaW5kZXhfa2V5ID0ga2V5c1s0XQogIGxvY2FsIHJlZGlyZWN0b3Jfa2V5ID0ga2V5c1s1XQoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGNhbXBhaWduX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIENhbXBhaWduIG5vdCBmb3VuZCcpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgbHVyZV9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBMdXJlIG5vdCBmb3VuZCcpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgcmVkaXJlY3Rvcl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBSZWRpcmVjdG9yIG5vdCBmb3VuZCcpCiAgZW5kCgogIGxvY2FsIHN0YXNoID0gewogICAgbHVyZV9pZCA9IHJlZGlzLmNhbGwoJ0hHRVQnLCBsdXJlX2tleSwgJ2x1cmVfaWQnKSwKICAgIHJlZGlyZWN0b3JfaWQgPSByZWRpcy5jYWxsKCdIR0VUJywgbHVyZV9rZXksICdyZWRpcmVjdG9yX2lkJyksCiAgICBvcmlnX3BhdGhfaWQgPSByZWRpcy5jYWxsKCdHRVQnLCBsdXJlX3BhdGhfa2V5KSwKICAgIG9yaWdfcmVkaXJlY3Rvcl9pZCA9IHJlZGlzLmNhbGwoJ0hHRVQnLCByZWRpcmVjdG9yX2tleSwgJ3JlZGlyZWN0b3JfaWQnKSwKICAgIGlzX2VuYWJsZWQgPSB0b251bWJlcihyZWRpcy5jYWxsKCdIR0VUJywgbHVyZV9rZXksICdpc19lbmFibGVkJykpLAogIH0KCiAgaWYgbm90IChzdGFzaC5sdXJlX2lkIGFuZCAjc3Rhc2gubHVyZV9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gc3Rhc2gubHVyZV9pZCcpCiAgZW5kCgogIGlmIG5vdCAoc3Rhc2gucmVkaXJlY3Rvcl9pZCBhbmQgI3N0YXNoLnJlZGlyZWN0b3JfaWQgPiAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIHN0YXNoLmRhcmVkaXJlY3Rvcl9pZCcpCiAgZW5kCgogIGlmIG5vdCAoc3Rhc2gub3JpZ19wYXRoX2lkIGFuZCAjc3Rhc2gub3JpZ19wYXRoX2lkID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBzdGFzaC5vcmlnX3BhdGhfaWQnKQogIGVuZAoKICBpZiBub3QgKHN0YXNoLmx1cmVfaWQgPT0gc3Rhc2gub3JpZ19wYXRoX2lkKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdGT1JCSURERU4gTHVyZSBwYXRoIG5vdCBtYXRjaCcpCiAgZW5kCgogIGlmIG5vdCAoc3Rhc2gub3JpZ19yZWRpcmVjdG9yX2lkIGFuZCBzdGFzaC5vcmlnX3JlZGlyZWN0b3JfaWQgfj0gJycpIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gc3Rhc2gub3JpZ19yZWRpcmVjdG9yX2lkJykKICBlbmQKCiAgaWYgbm90IChzdGFzaC5yZWRpcmVjdG9yX2lkID09IHN0YXNoLm9yaWdfcmVkaXJlY3Rvcl9pZCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnRk9SQklEREVOIEx1cmUgcmVkaXJlY3RvciBub3QgbWF0Y2gnKQogIGVuZAoKICBpZiBub3Qgc3Rhc2guaXNfZW5hYmxlZCB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIHN0YXNoLmlzX2VuYWJsZWQnKQogIGVuZAoKICBpZiBzdGFzaC5pc19lbmFibGVkIH49IDAgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnRk9SQklEREVOIEx1cmUgbm90IGRpc2FibGVkJykKICBlbmQKCiAgLS0gUG9pbnQgb2Ygbm8gcmV0dXJuCgogIHJlZGlzLmNhbGwoJ0RFTCcsIGx1cmVfa2V5KQoKICByZWRpcy5jYWxsKCdERUwnLCBsdXJlX3BhdGhfa2V5KQoKICByZWRpcy5jYWxsKCdaUkVNJywgbHVyZV9pbmRleF9rZXksIHN0YXNoLmx1cmVfaWQpCgogIHJlZGlzLmNhbGwoJ0hJTkNSQlknLCByZWRpcmVjdG9yX2tleSwgJ2x1cmVfY291bnQnLCAtMSkKCiAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnT0sgTHVyZSBkZWxldGVkJykKZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICdkZWxldGVfbHVyZScsCiAgY2FsbGJhY2sgPSBkZWxldGVfbHVyZSwKICBkZXNjcmlwdGlvbiA9ICdEZWxldGUgbHVyZScsCn0pCg==`,

  // 6-session.lua
  `IyFsdWEgbmFtZT1zZXNzaW9uCgotLVtbCiAgQ3JlYXRlIHNlc3Npb24KLS1dXQpsb2NhbCBmdW5jdGlvbiBjcmVhdGVfc2Vzc2lvbihrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gMyBhbmQgI2FyZ3MgPT0gNCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgZnVuY3Rpb24gdXNlJykKICBlbmQKCiAgbG9jYWwgY2FtcGFpZ25fa2V5ID0ga2V5c1sxXQogIGxvY2FsIHNlc3Npb25fa2V5ID0ga2V5c1syXQogIGxvY2FsIGVuYWJsZWRfcHJveHlfaW5kZXhfa2V5ID0ga2V5c1szXQoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIGNhbXBhaWduX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIENhbXBhaWduIG5vdCBmb3VuZCcpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgc2Vzc2lvbl9rZXkpID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ0NPTkZMSUNUIFNlc3Npb24gYWxscmVhZHkgZXhpc3RzJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdTQ0FSRCcsIGVuYWJsZWRfcHJveHlfaW5kZXhfa2V5KSA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBObyBlbmFibGVkIHByb3hpZXMgZm91bmQnKQogIGVuZAoKICBsb2NhbCBtb2RlbCA9IHsKICAgIGNhbXBhaWduX2lkID0gYXJnc1sxXSwKICAgIHNlc3Npb25faWQgPSBhcmdzWzJdLAogICAgcHJveHlfaWQgPSByZWRpcy5jYWxsKCdTUkFORE1FTUJFUicsIGVuYWJsZWRfcHJveHlfaW5kZXhfa2V5KSwKICAgIHNlY3JldCA9IGFyZ3NbM10sCiAgICBpc19sYW5kaW5nID0gMCwKICAgIG1lc3NhZ2VfY291bnQgPSAwLAogICAgY3JlYXRlZF9hdCA9IHRvbnVtYmVyKGFyZ3NbNF0pLAogICAgbGFzdF9hdXRoX2F0ID0gdG9udW1iZXIoYXJnc1s0XSksCiAgfQoKICBmb3IgZmllbGQsIHZhbHVlIGluIHBhaXJzKG1vZGVsKSBkbwogICAgaWYgbm90IHZhbHVlIHRoZW4KICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwuJyAuLiBmaWVsZCkKICAgIGVuZAogIGVuZAoKICBpZiBub3QgKCNtb2RlbC5jYW1wYWlnbl9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLmNhbXBhaWduX2lkJykKICBlbmQKCiAgaWYgbm90ICgjbW9kZWwuc2Vzc2lvbl9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLnNlc3Npb25faWQnKQogIGVuZAoKICBpZiBub3QgKCNtb2RlbC5wcm94eV9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLnByb3h5X2lkJykKICBlbmQKCiAgbG9jYWwgc3Rhc2ggPSB7CiAgICBuZXdfc2Vzc2lvbl9leHBpcmUgPSB0b251bWJlcihyZWRpcy5jYWxsKCdIR0VUJywgY2FtcGFpZ25fa2V5LCAnbmV3X3Nlc3Npb25fZXhwaXJlJykpLAogIH0KCiAgaWYgbm90IChzdGFzaC5uZXdfc2Vzc2lvbl9leHBpcmUgYW5kIHN0YXNoLm5ld19zZXNzaW9uX2V4cGlyZSA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gc3Rhc2gubmV3X3Nlc3Npb25fZXhwaXJlJykKICBlbmQKCiAgLS0gUG9pbnQgb2Ygbm8gcmV0dXJuCgogIGxvY2FsIHN0b3JlID0ge30KCiAgZm9yIGZpZWxkLCB2YWx1ZSBpbiBwYWlycyhtb2RlbCkgZG8KICAgIHRhYmxlLmluc2VydChzdG9yZSwgZmllbGQpCiAgICB0YWJsZS5pbnNlcnQoc3RvcmUsIHZhbHVlKQogIGVuZAoKICByZWRpcy5jYWxsKCdIU0VUJywgc2Vzc2lvbl9rZXksIHVucGFjayhzdG9yZSkpCgogIHJlZGlzLmNhbGwoJ1BFWFBJUkUnLCBzZXNzaW9uX2tleSwgc3Rhc2gubmV3X3Nlc3Npb25fZXhwaXJlKQoKICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBTZXNzaW9uIGNyZWF0ZWQnKQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ2NyZWF0ZV9zZXNzaW9uJywKICBjYWxsYmFjayA9IGNyZWF0ZV9zZXNzaW9uLAogIGRlc2NyaXB0aW9uID0gJ0NyZWF0ZSBzZXNzaW9uJywKfSkKCi0tW1sKICBSZWFkIHNlc3Npb24KLS1dXQpsb2NhbCBmdW5jdGlvbiByZWFkX3Nlc3Npb24oa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDIgYW5kICNhcmdzID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCBzZXNzaW9uX2tleSA9IGtleXNbMl0KCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBjYW1wYWlnbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiBuaWwKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBzZXNzaW9uX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIG5pbAogIGVuZAoKICAtLSBzdHlsdWE6IGlnbm9yZQogIGxvY2FsIHZhbHVlcyA9IHJlZGlzLmNhbGwoCiAgICAnSE1HRVQnLCBzZXNzaW9uX2tleSwKICAgICdjYW1wYWlnbl9pZCcsCiAgICAnc2Vzc2lvbl9pZCcsCiAgICAncHJveHlfaWQnLAogICAgJ3NlY3JldCcsCiAgICAnaXNfbGFuZGluZycsCiAgICAnbWVzc2FnZV9jb3VudCcsCiAgICAnY3JlYXRlZF9hdCcsCiAgICAnbGFzdF9hdXRoX2F0JwogICkKCiAgaWYgbm90ICgjdmFsdWVzID09IDgpIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gdmFsdWVzJykKICBlbmQKCiAgbG9jYWwgbW9kZWwgPSB7CiAgICBjYW1wYWlnbl9pZCA9IHZhbHVlc1sxXSwKICAgIHNlc3Npb25faWQgPSB2YWx1ZXNbMl0sCiAgICBwcm94eV9pZCA9IHZhbHVlc1szXSwKICAgIHNlY3JldCA9IHZhbHVlc1s0XSwKICAgIGlzX2xhbmRpbmcgPSB0b251bWJlcih2YWx1ZXNbNV0pLAogICAgbWVzc2FnZV9jb3VudCA9IHRvbnVtYmVyKHZhbHVlc1s2XSksCiAgICBjcmVhdGVkX2F0ID0gdG9udW1iZXIodmFsdWVzWzddKSwKICAgIGxhc3RfYXV0aF9hdCA9IHRvbnVtYmVyKHZhbHVlc1s4XSksCiAgfQoKICBmb3IgZmllbGQsIHZhbHVlIGluIHBhaXJzKG1vZGVsKSBkbwogICAgaWYgbm90IHZhbHVlIHRoZW4KICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBtb2RlbC4nIC4uIGZpZWxkKQogICAgZW5kCiAgZW5kCgogIHJldHVybiB7IG1hcCA9IG1vZGVsIH0KZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICdyZWFkX3Nlc3Npb24nLAogIGNhbGxiYWNrID0gcmVhZF9zZXNzaW9uLAogIGZsYWdzID0geyAnbm8td3JpdGVzJyB9LAogIGRlc2NyaXB0aW9uID0gJ1JlYWQgc2Vzc2lvbicsCn0pCgotLVtbCiAgQXV0aCBzZXNzaW9uCi0tXV0KbG9jYWwgZnVuY3Rpb24gYXV0aF9zZXNzaW9uKGtleXMsIGFyZ3MpCiAgaWYgbm90ICgja2V5cyA9PSAzIGFuZCAjYXJncyA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBmdW5jdGlvbiB1c2UnKQogIGVuZAoKICBsb2NhbCBjYW1wYWlnbl9rZXkgPSBrZXlzWzFdCiAgbG9jYWwgc2Vzc2lvbl9rZXkgPSBrZXlzWzJdCiAgbG9jYWwgZW5hYmxlZF9wcm94eV9pbmRleF9rZXkgPSBrZXlzWzNdCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgY2FtcGFpZ25fa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdOT1RfRk9VTkQgQ2FtcGFpZ24gbm90IGZvdW5kJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBzZXNzaW9uX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnRk9SQklEREVOIFNlc3Npb24gbm90IGZvdW5kJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdTQ0FSRCcsIGVuYWJsZWRfcHJveHlfaW5kZXhfa2V5KSA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBObyBlbmFibGVkIHByb3hpZXMgZm91bmQnKQogIGVuZAoKICBsb2NhbCBzdGFzaCA9IHsKICAgIGxhc3RfYXV0aF9hdCA9IHRvbnVtYmVyKGFyZ3NbMV0pLAogICAgcHJveHlfaWQgPSByZWRpcy5jYWxsKCdIR0VUJywgc2Vzc2lvbl9rZXksICdwcm94eV9pZCcpLAogICAgc2Vzc2lvbl9leHBpcmUgPSB0b251bWJlcihyZWRpcy5jYWxsKCdIR0VUJywgY2FtcGFpZ25fa2V5LCAnc2Vzc2lvbl9leHBpcmUnKSksCiAgfQoKICBpZiBub3Qgc3Rhc2gubGFzdF9hdXRoX2F0IHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIHN0YXNoLmxhc3RfYXV0aF9hdCcpCiAgZW5kCgogIGlmIG5vdCAoc3Rhc2gucHJveHlfaWQgYW5kICNzdGFzaC5wcm94eV9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gc3Rhc2gucHJveHlfaWQnKQogIGVuZAoKICBpZiBub3QgKHN0YXNoLnNlc3Npb25fZXhwaXJlIGFuZCBzdGFzaC5zZXNzaW9uX2V4cGlyZSA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gc3Rhc2guc2Vzc2lvbl9leHBpcmUnKQogIGVuZAoKICBpZiByZWRpcy5jYWxsKCdTSVNNRU1CRVInLCBlbmFibGVkX3Byb3h5X2luZGV4X2tleSwgc3Rhc2gucHJveHlfaWQpID09IDAgdGhlbgogICAgc3Rhc2gucHJveHlfaWQgPSByZWRpcy5jYWxsKCdTUkFORE1FTUJFUicsIGVuYWJsZWRfcHJveHlfaW5kZXhfa2V5KQoKICAgIGlmIG5vdCAoc3Rhc2gucHJveHlfaWQgYW5kICNzdGFzaC5wcm94eV9pZCA+IDApIHRoZW4KICAgICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSBzdGFzaC5wcm94eV9pZCcpCiAgICBlbmQKICBlbmQKCiAgLS0gc3R5bHVhOiBpZ25vcmUKICByZWRpcy5jYWxsKAogICAgJ0hTRVQnLCBzZXNzaW9uX2tleSwKICAgICdwcm94eV9pZCcsIHN0YXNoLnByb3h5X2lkLAogICAgJ2xhc3RfYXV0aF9hdCcsIHN0YXNoLmxhc3RfYXV0aF9hdAogICkKCiAgcmVkaXMuY2FsbCgnUEVYUElSRScsIHNlc3Npb25fa2V5LCBzdGFzaC5zZXNzaW9uX2V4cGlyZSkKCiAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnT0sgU2Vzc2lvbiBhdXRob3JpemVkJykKZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICdhdXRoX3Nlc3Npb24nLAogIGNhbGxiYWNrID0gYXV0aF9zZXNzaW9uLAogIGRlc2NyaXB0aW9uID0gJ0F1dGggc2Vzc2lvbicsCn0pCgotLVtbCiAgVXBncmFkZSBzZXNzaW9uCi0tXV0KbG9jYWwgZnVuY3Rpb24gdXBncmFkZV9zZXNzaW9uKGtleXMsIGFyZ3MpCiAgaWYgbm90ICgja2V5cyA9PSAzIGFuZCAjYXJncyA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBmdW5jdGlvbiB1c2UnKQogIGVuZAoKICBsb2NhbCBjYW1wYWlnbl9rZXkgPSBrZXlzWzFdCiAgbG9jYWwgbHVyZV9rZXkgPSBrZXlzWzJdCiAgbG9jYWwgc2Vzc2lvbl9rZXkgPSBrZXlzWzNdCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgY2FtcGFpZ25fa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdOT1RfRk9VTkQgQ2FtcGFpZ24gbm90IGZvdW5kJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBsdXJlX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIEx1cmUgbm90IGZvdW5kJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBzZXNzaW9uX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLnN0YXR1c19yZXBseSgnTk9UX0ZPVU5EIFNlc3Npb24gbm90IGZvdW5kJykKICBlbmQKCiAgbG9jYWwgc3Rhc2ggPSB7CiAgICB0ZXN0X3NlY3JldCA9IGFyZ3NbMV0sCiAgICBvcmlnX3NlY3JldCA9IHJlZGlzLmNhbGwoJ0hHRVQnLCBzZXNzaW9uX2tleSwgJ3NlY3JldCcpLAogICAgaXNfbGFuZGluZyA9IHRvbnVtYmVyKHJlZGlzLmNhbGwoJ0hHRVQnLCBzZXNzaW9uX2tleSwgJ2lzX2xhbmRpbmcnKSksCiAgfQoKICBpZiBub3QgKHN0YXNoLnRlc3Rfc2VjcmV0IGFuZCAjc3Rhc2gudGVzdF9zZWNyZXQgPiAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBzdGFzaC50ZXN0X3NlY3JldCcpCiAgZW5kCgogIGlmIG5vdCAoc3Rhc2gub3JpZ19zZWNyZXQgYW5kICNzdGFzaC5vcmlnX3NlY3JldCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIE1hbGZvcm0gc3Rhc2gub3JpZ19zZWNyZXQnKQogIGVuZAoKICBpZiBub3Qgc3Rhc2guaXNfbGFuZGluZyB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIHN0YXNoLmlzX2xhbmRpbmcnKQogIGVuZAoKICBpZiBzdGFzaC50ZXN0X3NlY3JldCB+PSBzdGFzaC5vcmlnX3NlY3JldCB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdGT1JCSURERU4gU2Vzc2lvbiBzZWNyZXQgbm90IG1hdGNoJykKICBlbmQKCiAgaWYgc3Rhc2guaXNfbGFuZGluZyB+PSAwIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ09LIFNlc3Npb24gYWxscmVhZHkgdXBncmFkZWQnKQogIGVuZAoKICAtLSBQb2ludCBvZiBubyByZXR1cm4KCiAgcmVkaXMuY2FsbCgnSFNFVCcsIHNlc3Npb25fa2V5LCAnaXNfbGFuZGluZycsIDEpCgogIHJlZGlzLmNhbGwoJ0hJTkNSQlknLCBsdXJlX2tleSwgJ3Nlc3Npb25fY291bnQnLCAxKQoKICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBTZXNzaW9uIHVwZ3JhZGVkJykKZW5kCgpyZWRpcy5yZWdpc3Rlcl9mdW5jdGlvbih7CiAgZnVuY3Rpb25fbmFtZSA9ICd1cGdyYWRlX3Nlc3Npb24nLAogIGNhbGxiYWNrID0gdXBncmFkZV9zZXNzaW9uLAogIGRlc2NyaXB0aW9uID0gJ1VwZ3JhZGUgc2Vzc2lvbicsCn0pCg==`,

  // 7-message.lua
  `IyFsdWEgbmFtZT1tZXNzYWdlCgotLVtbCiAgQ3JlYXRlIG1lc3NhZ2UKLS1dXQpsb2NhbCBmdW5jdGlvbiBjcmVhdGVfbWVzc2FnZShrZXlzLCBhcmdzKQogIGlmIG5vdCAoI2tleXMgPT0gNSBhbmQgI2FyZ3MgPT0gMTkpIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCBtZXNzYWdlX2tleSA9IGtleXNbMl0KICBsb2NhbCBwcm94eV9rZXkgPSBrZXlzWzNdCiAgbG9jYWwgdGFyZ2V0X2tleSA9IGtleXNbNF0KICBsb2NhbCBzZXNzaW9uX2tleSA9IGtleXNbNV0KCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBjYW1wYWlnbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBDYW1wYWlnbiBub3QgZm91bmQnKQogIGVuZAoKICBpZiBub3QgKHJlZGlzLmNhbGwoJ0VYSVNUUycsIG1lc3NhZ2Vfa2V5KSA9PSAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdDT05GTElDVCBNZXNzYWdlIGFsbHJlYWR5IGV4aXN0cycpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgcHJveHlfa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdOT1RfRk9VTkQgUHJveHkgbm90IGZvdW5kJykKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCB0YXJnZXRfa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdOT1RfRk9VTkQgVGFyZ2V0IG5vdCBmb3VuZCcpCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgc2Vzc2lvbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiByZWRpcy5zdGF0dXNfcmVwbHkoJ05PVF9GT1VORCBTZXNzaW9uIG5vdCBmb3VuZCcpCiAgZW5kCgogIGxvY2FsIG1vZGVsID0gewogICAgY2FtcGFpZ25faWQgPSBhcmdzWzFdLAogICAgbWVzc2FnZV9pZCA9IGFyZ3NbMl0sCiAgICBwcm94eV9pZCA9IGFyZ3NbM10sCiAgICB0YXJnZXRfaWQgPSBhcmdzWzRdLAogICAgc2Vzc2lvbl9pZCA9IGFyZ3NbNV0sCiAgICBtZXRob2QgPSBhcmdzWzZdLAogICAgdXJsID0gYXJnc1s3XSwKICAgIGlzX3N0cmVhbWluZyA9IGFyZ3NbOF0sCiAgICByZXF1ZXN0X2hlYWRlcnMgPSBhcmdzWzldLAogICAgcmVxdWVzdF9ib2R5ID0gYXJnc1sxMF0sCiAgICByZXNwb25zZV9oZWFkZXJzID0gYXJnc1sxMV0sCiAgICByZXNwb25zZV9ib2R5ID0gYXJnc1sxMl0sCiAgICBjbGllbnRfaXAgPSBhcmdzWzEzXSwKICAgIHN0YXR1cyA9IHRvbnVtYmVyKGFyZ3NbMTRdKSwKICAgIHNjb3JlID0gdG9udW1iZXIoYXJnc1sxNV0pLAogICAgc3RhcnRfdGltZSA9IHRvbnVtYmVyKGFyZ3NbMTZdKSwKICAgIGZpbmlzaF90aW1lID0gdG9udW1iZXIoYXJnc1sxN10pLAogICAgY29ubmVjdGlvbiA9IGFyZ3NbMThdLAogICAgY3JlYXRlZF9hdCA9IHRvbnVtYmVyKGFyZ3NbMTldKSwKICB9CgogIGZvciBmaWVsZCwgdmFsdWUgaW4gcGFpcnMobW9kZWwpIGRvCiAgICBpZiBub3QgdmFsdWUgdGhlbgogICAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBtb2RlbC4nIC4uIGZpZWxkKQogICAgZW5kCiAgZW5kCgogIGlmIG5vdCAobW9kZWwuY2FtcGFpZ25faWQgYW5kICNtb2RlbC5jYW1wYWlnbl9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLmNhbXBhaWduX2lkJykKICBlbmQKCiAgaWYgbm90IChtb2RlbC5tZXNzYWdlX2lkIGFuZCAjbW9kZWwubWVzc2FnZV9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLm1lc3NhZ2VfaWQnKQogIGVuZAoKICBpZiBub3QgKG1vZGVsLnByb3h5X2lkIGFuZCAjbW9kZWwucHJveHlfaWQgPiAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBtb2RlbC5wcm94eV9pZCcpCiAgZW5kCgogIGlmIG5vdCAobW9kZWwudGFyZ2V0X2lkIGFuZCAjbW9kZWwudGFyZ2V0X2lkID4gMCkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgV3JvbmcgbW9kZWwudGFyZ2V0X2lkJykKICBlbmQKCiAgaWYgbm90IChtb2RlbC5zZXNzaW9uX2lkIGFuZCAjbW9kZWwuc2Vzc2lvbl9pZCA+IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIG1vZGVsLnNlc3Npb25faWQnKQogIGVuZAoKICBsb2NhbCBzdGFzaCA9IHsKICAgIG1lc3NhZ2VfZXhwaXJlID0gdG9udW1iZXIocmVkaXMuY2FsbCgnSEdFVCcsIGNhbXBhaWduX2tleSwgJ21lc3NhZ2VfZXhwaXJlJykpLAogIH0KCiAgaWYgbm90IChzdGFzaC5tZXNzYWdlX2V4cGlyZSBhbmQgc3Rhc2gubWVzc2FnZV9leHBpcmUgPiAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIHN0YXNoLm1lc3NhZ2VfZXhwaXJlJykKICBlbmQKCiAgLS0gUG9pbnQgb2Ygbm8gcmV0dXJuCgogIGxvY2FsIHN0b3JlID0ge30KCiAgZm9yIGZpZWxkLCB2YWx1ZSBpbiBwYWlycyhtb2RlbCkgZG8KICAgIHRhYmxlLmluc2VydChzdG9yZSwgZmllbGQpCiAgICB0YWJsZS5pbnNlcnQoc3RvcmUsIHZhbHVlKQogIGVuZAoKICByZWRpcy5jYWxsKCdIU0VUJywgbWVzc2FnZV9rZXksIHVucGFjayhzdG9yZSkpCgogIHJlZGlzLmNhbGwoJ0hJTkNSQlknLCBwcm94eV9rZXksICdtZXNzYWdlX2NvdW50JywgMSkKICByZWRpcy5jYWxsKCdISU5DUkJZJywgdGFyZ2V0X2tleSwgJ21lc3NhZ2VfY291bnQnLCAxKQogIHJlZGlzLmNhbGwoJ0hJTkNSQlknLCBzZXNzaW9uX2tleSwgJ21lc3NhZ2VfY291bnQnLCAxKQoKICByZWRpcy5jYWxsKCdQRVhQSVJFJywgbWVzc2FnZV9rZXksIHN0YXNoLm1lc3NhZ2VfZXhwaXJlKQoKICByZXR1cm4gcmVkaXMuc3RhdHVzX3JlcGx5KCdPSyBNZXNzYWdlIGNyZWF0ZWQnKQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ2NyZWF0ZV9tZXNzYWdlJywKICBjYWxsYmFjayA9IGNyZWF0ZV9tZXNzYWdlLAogIGRlc2NyaXB0aW9uID0gJ0NyZWF0ZSBtZXNzYWdlJywKfSkKCi0tW1sKICBSZWFkIG1lc3NhZ2UKLS1dXQpsb2NhbCBmdW5jdGlvbiByZWFkX21lc3NhZ2Uoa2V5cywgYXJncykKICBpZiBub3QgKCNrZXlzID09IDIgYW5kICNhcmdzID09IDApIHRoZW4KICAgIHJldHVybiByZWRpcy5lcnJvcl9yZXBseSgnRVJSIFdyb25nIGZ1bmN0aW9uIHVzZScpCiAgZW5kCgogIGxvY2FsIGNhbXBhaWduX2tleSA9IGtleXNbMV0KICBsb2NhbCBtZXNzYWdlX2tleSA9IGtleXNbMl0KCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBjYW1wYWlnbl9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiBuaWwKICBlbmQKCiAgaWYgbm90IChyZWRpcy5jYWxsKCdFWElTVFMnLCBtZXNzYWdlX2tleSkgPT0gMSkgdGhlbgogICAgcmV0dXJuIG5pbAogIGVuZAoKICAtLSBzdHlsdWE6IGlnbm9yZQogIGxvY2FsIHZhbHVlcyA9IHJlZGlzLmNhbGwoCiAgICAnSE1HRVQnLCBtZXNzYWdlX2tleSwKICAgICdjYW1wYWlnbl9pZCcsCiAgICAnbWVzc2FnZV9pZCcsCiAgICAncHJveHlfaWQnLAogICAgJ3RhcmdldF9pZCcsCiAgICAnc2Vzc2lvbl9pZCcsCiAgICAnbWV0aG9kJywKICAgICd1cmwnLAogICAgJ2lzX3N0cmVhbWluZycsCiAgICAnc3RhdHVzJywKICAgICdzY29yZScsCiAgICAnY3JlYXRlZF9hdCcKICApCgogIGlmIG5vdCAoI3ZhbHVlcyA9PSAxMSkgdGhlbgogICAgcmV0dXJuIHJlZGlzLmVycm9yX3JlcGx5KCdFUlIgTWFsZm9ybSB2YWx1ZXMnKQogIGVuZAoKICBsb2NhbCBtb2RlbCA9IHsKICAgIGNhbXBhaWduX2lkID0gdmFsdWVzWzFdLAogICAgbWVzc2FnZV9pZCA9IHZhbHVlc1syXSwKICAgIHByb3h5X2lkID0gdmFsdWVzWzNdLAogICAgdGFyZ2V0X2lkID0gdmFsdWVzWzRdLAogICAgc2Vzc2lvbl9pZCA9IHZhbHVlc1s1XSwKICAgIG1ldGhvZCA9IHZhbHVlc1s2XSwKICAgIHVybCA9IHZhbHVlc1s3XSwKICAgIGlzX3N0cmVhbWluZyA9IHRvbnVtYmVyKHZhbHVlc1s4XSksCiAgICBzdGF0dXMgPSB0b251bWJlcih2YWx1ZXNbOV0pLAogICAgc2NvcmUgPSB0b251bWJlcih2YWx1ZXNbMTBdKSwKICAgIGNyZWF0ZWRfYXQgPSB0b251bWJlcih2YWx1ZXNbMTFdKSwKICB9CgogIGZvciBmaWVsZCwgdmFsdWUgaW4gcGFpcnMobW9kZWwpIGRvCiAgICBpZiBub3QgdmFsdWUgdGhlbgogICAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIG1vZGVsLicgLi4gZmllbGQpCiAgICBlbmQKICBlbmQKCiAgcmV0dXJuIHsgbWFwID0gbW9kZWwgfQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ3JlYWRfbWVzc2FnZScsCiAgY2FsbGJhY2sgPSByZWFkX21lc3NhZ2UsCiAgZmxhZ3MgPSB7ICduby13cml0ZXMnIH0sCiAgZGVzY3JpcHRpb24gPSAnUmVhZCBtZXNzYWdlJywKfSkKCi0tW1sKICBSZWFkIGZ1bGwgbWVzc2FnZQotLV1dCmxvY2FsIGZ1bmN0aW9uIHJlYWRfZnVsbF9tZXNzYWdlKGtleXMsIGFyZ3MpCiAgaWYgbm90ICgja2V5cyA9PSAyIGFuZCAjYXJncyA9PSAwKSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBXcm9uZyBmdW5jdGlvbiB1c2UnKQogIGVuZAoKICBsb2NhbCBjYW1wYWlnbl9rZXkgPSBrZXlzWzFdCiAgbG9jYWwgbWVzc2FnZV9rZXkgPSBrZXlzWzJdCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgY2FtcGFpZ25fa2V5KSA9PSAxKSB0aGVuCiAgICByZXR1cm4gbmlsCiAgZW5kCgogIGlmIG5vdCAocmVkaXMuY2FsbCgnRVhJU1RTJywgbWVzc2FnZV9rZXkpID09IDEpIHRoZW4KICAgIHJldHVybiBuaWwKICBlbmQKCiAgLS0gc3R5bHVhOiBpZ25vcmUKICBsb2NhbCB2YWx1ZXMgPSByZWRpcy5jYWxsKAogICAgJ0hNR0VUJywgbWVzc2FnZV9rZXksCiAgICAnY2FtcGFpZ25faWQnLAogICAgJ21lc3NhZ2VfaWQnLAogICAgJ3Byb3h5X2lkJywKICAgICd0YXJnZXRfaWQnLAogICAgJ3Nlc3Npb25faWQnLAogICAgJ21ldGhvZCcsCiAgICAndXJsJywKICAgICdpc19zdHJlYW1pbmcnLAogICAgJ3JlcXVlc3RfaGVhZGVycycsCiAgICAncmVxdWVzdF9ib2R5JywKICAgICdyZXNwb25zZV9oZWFkZXJzJywKICAgICdyZXNwb25zZV9ib2R5JywKICAgICdjbGllbnRfaXAnLAogICAgJ3N0YXR1cycsCiAgICAnc2NvcmUnLAogICAgJ3N0YXJ0X3RpbWUnLAogICAgJ2ZpbmlzaF90aW1lJywKICAgICdjb25uZWN0aW9uJywKICAgICdjcmVhdGVkX2F0JwogICkKCiAgaWYgbm90ICgjdmFsdWVzID09IDE5KSB0aGVuCiAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIHZhbHVlcycpCiAgZW5kCgogIGxvY2FsIG1vZGVsID0gewogICAgY2FtcGFpZ25faWQgPSB2YWx1ZXNbMV0sCiAgICBtZXNzYWdlX2lkID0gdmFsdWVzWzJdLAogICAgcHJveHlfaWQgPSB2YWx1ZXNbM10sCiAgICB0YXJnZXRfaWQgPSB2YWx1ZXNbNF0sCiAgICBzZXNzaW9uX2lkID0gdmFsdWVzWzVdLAogICAgbWV0aG9kID0gdmFsdWVzWzZdLAogICAgdXJsID0gdmFsdWVzWzddLAogICAgaXNfc3RyZWFtaW5nID0gdG9udW1iZXIodmFsdWVzWzhdKSwKICAgIHJlcXVlc3RfaGVhZGVycyA9IHZhbHVlc1s5XSwKICAgIHJlcXVlc3RfYm9keSA9IHZhbHVlc1sxMF0sCiAgICByZXNwb25zZV9oZWFkZXJzID0gdmFsdWVzWzExXSwKICAgIHJlc3BvbnNlX2JvZHkgPSB2YWx1ZXNbMTJdLAogICAgY2xpZW50X2lwID0gdmFsdWVzWzEzXSwKICAgIHN0YXR1cyA9IHRvbnVtYmVyKHZhbHVlc1sxNF0pLAogICAgc2NvcmUgPSB0b251bWJlcih2YWx1ZXNbMTVdKSwKICAgIHN0YXJ0X3RpbWUgPSB0b251bWJlcih2YWx1ZXNbMTZdKSwKICAgIGZpbmlzaF90aW1lID0gdG9udW1iZXIodmFsdWVzWzE3XSksCiAgICBjb25uZWN0aW9uID0gdmFsdWVzWzE4XSwKICAgIGNyZWF0ZWRfYXQgPSB0b251bWJlcih2YWx1ZXNbMTldKSwKICB9CgogIGZvciBmaWVsZCwgdmFsdWUgaW4gcGFpcnMobW9kZWwpIGRvCiAgICBpZiBub3QgdmFsdWUgdGhlbgogICAgICByZXR1cm4gcmVkaXMuZXJyb3JfcmVwbHkoJ0VSUiBNYWxmb3JtIG1vZGVsLicgLi4gZmllbGQpCiAgICBlbmQKICBlbmQKCiAgcmV0dXJuIHsgbWFwID0gbW9kZWwgfQplbmQKCnJlZGlzLnJlZ2lzdGVyX2Z1bmN0aW9uKHsKICBmdW5jdGlvbl9uYW1lID0gJ3JlYWRfZnVsbF9tZXNzYWdlJywKICBjYWxsYmFjayA9IHJlYWRfZnVsbF9tZXNzYWdlLAogIGZsYWdzID0geyAnbm8td3JpdGVzJyB9LAogIGRlc2NyaXB0aW9uID0gJ1JlYWQgZnVsbCBtZXNzYWdlJywKfSkK`,
]

export function getRedisFunctions(): string[] {
  return REDIS_FUNCTIONS.map((data) => Buffer.from(data, 'base64').toString())
}
